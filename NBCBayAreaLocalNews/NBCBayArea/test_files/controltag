
/* Controltag Loader for NBCUniversal */
(function(){
  function debugLog(msg) {
    var isDebug = /kxdebug=(1|true)/.test(location);
    if (isDebug && typeof window.console === 'object' && typeof console.info === 'function') {
      console.info(msg);
    }
  }

  function loadCT(url, callback) {
    debugLog('Loading Krux control tag.');
    var ct_element = document.createElement('script');
    ct_element.async = true;
    ct_element.src = url;

    ct_element.onload = ct_element.onreadystatechange = function() {
      var state = ct_element.readyState;
      if (!callback.done && (!state || /loaded|complete/.test(state))) {
        callback.done = true;
        callback();
      }
    };

    // Fetch the first script element, so we can insert the
    // controltag before it. There *must* be at least one
    // script element, or this code would never be called
    var sibling = document.getElementsByTagName('script')[0];
    sibling.parentNode.insertBefore(ct_element, sibling);
  };

  function loadConfig() {
    
    
    debugLog('Loading krux configuration.');

    var config = {"confid": "Hhr_tYbL", "context_terms": [], "dnt": null, "geo":{"COUNTRY":"US", "REGION":"CA", "CITY":"BERKELEY", "GEOREGION":"246", "DMA":"807", "PMSA":"5775", "AREACODE":"510", "COUNTY":"ALAMEDA", "FIPS":"06001", "LATITUDE":"37.8718", "LONGITUDE":"-122.2718", "TIMEZONE":"PST", "ZIP":"94701-94705 94707-94710 94712 94720", "CONTINENT":"NA"}, "params": {"beacon_host": "beacon.krxd.net", "capture_js_errors": true, "capture_leakage": true, "client_side_storage": "localStorage,cookie", "context_terms": "false", "control_tag_load_sync": "false", "control_tag_namespace": null, "control_tag_pixel_throttle": null, "control_tag_stats_prefix": "nbcu", "control_tag_version": "nbcu", "datatag_version": "3", "jslog_host": "jslog.krxd.net", "max_slot_time": 1000, "no_pii": 0, "revenue_optimization": false, "services_host": "apiservices.krxd.net", "site_level_supertag_config": "site", "supertag_requires_approval": "true"}, "partner_segment_map": {}, "publisher": {"id": 10108, "name": "NBCUniversal", "uuid": "54983c83-8810-4a6b-9ff1-81f7349ce967"}, "realtime_segments": [{"id": "nxnwnhuug", "test": ["and", ["or", ["and", ["or", "$event_IwMx30gy"]]]]}], "segments": [], "services": {"data": "//beacon.krxd.net/data.gif", "event": "//beacon.krxd.net/event.gif", "impression": "//beacon.krxd.net/ad_impression.gif", "log": "//jslog.krxd.net/jslog.gif", "pixel": "//beacon.krxd.net/pixel.gif", "social": "//beacon.krxd.net/social.gif", "stats": "//apiservices.krxd.net/stats", "um": "//apiservices.krxd.net/um", "userData": "//apiservices.krxd.net/user_data/segments/3"}, "site": {"id": 10291, "name": "LIM"}, "tags": [{"content": "<script type=\"text/javascript\">\r\n// DFP premium.\r\n(function(require) {\r\n  var store = require('store');\r\n  var _ = require('util');  \r\n  var segments;\r\n  \r\n  function handleUserDataResponse(r) {\r\n    // Handle the response as usual.\r\n    segments.handleUserDataResponse(r);\r\n    \r\n    // Override localStorage.kxuser with a case-insensitive value for DFP premium.\r\n    // This will get read by the interchange direct snippet for Krux.user\r\n    // and Krux.dfpKeyValues\r\n    if(r.kuid_long) {\r\n      store.set('user', r.kuid_long, store.DAYS*30);\r\n    }\r\n  }\r\n  \r\n  // Our own fetch uses our own handleResponse\r\n  function fetch() {\r\n    var options = {\r\n      url: _.get('url_userData'),\r\n      data: {pubid: _.get('pubid')},\r\n      callback: 'kxjsonp_userData',\r\n      done: handleUserDataResponse\r\n    };\r\n    if(!segments.readTechFromStore()) {\r\n      options.data.technographics = 1;\r\n    }\r\n    require('http').jsonp(options);  \r\n  }\r\n  \r\n  \r\n  if(!store.get('segWait')) {\r\n    // disable segments.fetch and use our own\r\n    _.set('segWait', 1, store.MINUTES*5);\r\n    _.onOnce('dom:load', fetch);\r\n    _.fire('user_data_fetch_scheduled');\r\n  }\r\n  \r\n  // Finally, require segments as usual.\r\n  segments = require('segments');\r\n}(Krux.require));\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 21575, "internal": 1, "library_tag_config": {}, "method": "document", "name": "Krux Load Segments V2", "require": "", "target": "", "target_action": null, "tier": 2, "timing": "asap", "type": "library"}, {"content": "<script>\r\n// tag intentionally blank\r\n</script", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 27697, "internal": 39, "method": "document", "name": "HealthyOffers - NBCU (via LiveRamp) provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n// this tag is intentionally blank\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 11327, "internal": 6, "method": "document", "name": "Technographic Data provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n// This tag intentionally empty\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 11108, "internal": 15, "method": "document", "name": "Acxiom provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n    Krux('require:http').pixel({\r\n      url: \"//loadm.exelator.com/load\",\r\n      data: {\r\n          _kdpid: 'e4942ff0-4070-4896-a7ef-e6a5a30ce9f9',\r\n          buid: kuid,\r\n          p: '204',\r\n          g: '270',\r\n          j: '0'\r\n      }});\r\n  }\r\n  })();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 11109, "internal": 11, "method": "document", "name": "eXelate Media provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n(function() {\r\n  // adadvisor redirects to http://logger... so it's not https safe\r\n  if (location.protocol == \"http:\") {\r\n     var u = \"https://adadvisor.net/adscores/g.js?sid=9212244187&_kdpid=2111c0af-fc3a-446f-ab07-63aa74fbde8e\";\r\n     (new Image()).src = u;\r\n   }\r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 19045, "internal": 22, "method": "document", "name": "AdAdvisor S2S provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n    Krux('require:http').pixel({\r\n      url: \"//p.acxiom-online.com/pixel/sci\",\r\n      data: {\r\n          uid: kuid,\r\n          _kdpid: 'f19b7626-3732-4dcc-bac5-8d2c937dae9a',\r\n          pid: 3021\r\n      }});\r\n  }\r\n  })();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 18290, "internal": 21, "method": "document", "name": "Acxiom S2S provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 16002, "internal": 13, "method": "document", "name": "Quantcast provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload"}, {"content": "<script type=\"text/javascript\">Krux('social.init');</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 24980, "internal": 1, "library_tag_config": {}, "method": "document", "name": "Krux Track Social", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "library"}, {"content": "<script>\r\n(function(){\r\n  if (window.KRUX) {\r\n    var pubid = KRUXSetup.pubid;\r\n  } else if (window.Krux) {\r\n    var pubid = Krux('get', 'pubid');\r\n  } else { \r\n    return;\r\n  }\r\n  var prefix = location.protocol == 'https:' ? \"https:\" : \"http:\";\r\n  var kurl = prefix + '//beacon.krxd.net/data.gif?_kdpid=890a6228-04af-4630-85b6-0b49dee6157f&pid=' + pubid;\r\n  var u = prefix + '//api.bizographics.com/v1/profile.redirect?api_key=595bae8dbc0c4c42b4544e688b10c002' + \r\n        '&callback_url=' + escape(kurl);\r\n  var i = new Image();\r\n  i.src = u;\r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 14019, "internal": 2, "method": "document", "name": "Bizo provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n(function() {\r\n  // adadvisor redirects to http://logger... so it's not https safe\r\n  if (location.protocol == \"http:\") {\r\n     var u = \"http://adadvisor.net/adscores/g.js?sid=9212244187&_kdpid=911765d2-536f-4475-8fd5-92b73478fb8f\";\r\n     (new Image()).src = u;\r\n   }\r\n})();\r\n</script>\r\n", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 15821, "internal": 1, "method": "document", "name": "Targus/AdAdvisor provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 23254, "internal": 14, "method": "document", "name": "Krux Geographic Data provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload"}, {"content": "<script>\r\n// Blank\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 14072, "internal": 19, "method": "document", "name": "Nielsen (via Exelate) provider tag", "require": "", "target": null, "target_action": "append", "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script>\r\n(function() {\r\n  // Do the SNAS cookies taste like IDX cookies?\r\n  var idx_cookie = Krux('scrape.cookie', 'idx_d'),\r\n      snas_cookie = Krux('scrape.cookie', 'snas_d'),\r\n      cookie = idx_cookie || snas_cookie;\r\n  if ( ! cookie ) {\r\n    return;\r\n  }\r\n  var m3 = cookie.match(/([0-9]{3})$/);\r\n  if (m3) {\r\n     Krux('set', 'user_attr_idx_3', m3[1]);\r\n  }\r\n  var m2 = cookie.match(/(65151g|15112g)/);\r\n  if (m2) {\r\n     Krux('set', 'user_attr_idx_2', m2[1]);\r\n  }\r\n  var stripped = cookie.replace(/(65151|15112)/, '').replace(/[0-9]{3}$/, '');\r\n  var m1 = stripped.match(/[0-9]{2,5}[Lg]/g);\r\n  if (m1) {\r\n     Krux('set', 'user_attr_idx_1', m1);\r\n  }\r\n\r\n  var idx_u_cookie = Krux('scrape.cookie', 'idx_u');\r\n  if (idx_u_cookie) {\r\n    Krux('set', 'user_attr_idx_uid', idx_u_cookie);\r\n  } \r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "id": 12072, "internal": 1, "method": "document", "name": "IDX Cookie Scraper", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script language=\"JavaScript\" type=\"text/javascript\" src=\"//js.revsci.net/gateway/gw.js?csid=F09828&auto=t&bpid=nbcu\"></script>", "content_type": "html", "docwrite": null, "end_date": "2014-12-31", "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "id": 14704, "internal": false, "method": "iframe", "name": "AudienceScience - P&G", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script type=\"text/javascript\">\r\n  (function() {\r\n    var cs = document.createElement('script'); cs.type = 'text/javascript'; cs.async = true;\r\n    cs.src = ('https:' == document.location.protocol ? 'https://secure-' : 'http://') + 'static.crowdscience.com/start-7881f43af0.js';\r\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(cs, s);\r\n  })();\r\n</script>", "content_type": "html", "criteria": [{"name": "section", "operator": "!=", "value": "home"}, {"name": "sub_section", "operator": "!=", "value": "home"}, {"name": "url", "operator": "contains", "value": "qa.pub.cnbc.com"}], "docwrite": null, "execution_results": {"docwrite": false, "listeners": [{"capture": false, "func": "function (f) {\n    if (!(\"readystatechange\" == f.type && \"complete\" != c.readyState) &&\n        ((\"load\" == f.type ? a : c)[j](h + f.type, q, !1), !e && (e = !0))) {\n        b.call(a, f.type || f);\n    }\n}", "type": "load"}], "onloadSafe": true}, "id": 13990, "internal": false, "method": "document", "name": "Crowd Science Research Tag", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script>\r\n(function(){\r\n  var kuid = window.Krux.user;\r\n  var liveramp_url =\r\n'https://idsync.rlcdn.com/378648.gif?partner_uid=' + kuid;\r\n  var i = new Image();\r\n  i.src = liveramp_url;\r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "freq_cap": 3, "id": 27564, "internal": false, "method": "document", "name": "LiveRamp User Match Pixel", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script type=\"text/javascript\">\r\n  Krux('dataprovider.exelate');\r\n</script>", "content_type": "html", "criteria": [{"name": "section", "operator": "!=", "value": "nbcolympics.com, www.nbcolympics.com"}, {"name": "url", "operator": "contains", "value": "qa.pub.cnbc.com"}], "docwrite": null, "execution_results": null, "freq_cap": 1, "id": 10690, "internal": false, "method": "document", "name": "Krux eXelate cookie match", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script type=\"text/javascript\"> \r\n(function() { \r\n  function findEl(els) {\r\n    for(var i = 0; i < els.length; ++i) {\r\n      try {\r\n        var pathname = (m = els[i].src.match(/\\.doubleclick\\.net(\\/[^;]*)/)) ? \r\n          m[1] : '';\r\n        \r\n        if(pathname) {\r\n          var parts = pathname.split('/');\r\n          Krux.require('util').set({\r\n            page_attr_dfpsite: parts[2],\r\n            page_attr_dfpzone: parts[3]\r\n          });\r\n          return true;   \r\n        }\r\n      } catch (e) {}\r\n    }\r\n  }\r\n  \r\n  findEl(document.getElementsByTagName('SCRIPT')) ||\r\n  findEl(document.getElementsByTagName('IFRAME'));\r\n  \r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 11476, "internal": 1, "method": "document", "name": "krux-dfp-site-zone", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script>\r\n(function () {\r\n    if (location.protocol.indexOf('s') > -1) {\r\n       return;\r\n    }\r\n    var u = \"http://pixel.quantserve.com/seg/r;a=p-9eJ8k4iSzux46;rand=\" +\r\n        Math.round(Math.random() * 999999942) + \";redirect=\" +\r\n        \"http://beacon.krxd.net/data.gif?_kdpid=c28722fa-1ec3-4a33-838f-d360c76c0aca&segs=!qcsegs\";\r\n\r\n    (new Image()).src = u;\r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "id": 15596, "internal": false, "method": "document", "name": "Quantcast / Krux", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "publisher"}, {"content": "<script type='text/javascript' charset='utf-8'>\r\n  function CS_data_callback(cs_data) {\r\n    if (cs_data && cs_data.segments) {\r\n      var p = location.protocol === 'https:' ? 'https:' : 'http:';\r\n      new Image().src = p + '//beacon.krxd.net/data.gif?_kdpid=b1f402c1-9cee-4d2c-95e8-f87ec628694e&cs_segs=' + \r\n        encodeURIComponent(cs_data.segments.join(','));\r\n    }\r\n  } \r\n</script> \r\n<script src='http://static.crowdscience.com/max-7881f43af0.js?callback=CS_data_callback' type='text/javascript' charset='utf-8'></script> ", "content_type": "html", "docwrite": null, "execution_results": null, "freq_cap": 3, "id": 20727, "internal": 1, "method": "document", "name": "Crowd Science (NBCU) provider tag", "require": "", "target": "", "target_action": null, "tier": 1, "timing": "onload", "type": "data provider"}, {"content": "<script type=\"text/javascript\">\r\n(function() {\r\n  var prvx_segs = Krux('get', 'user_prvx_segments') || [];\r\n  if (prvx_segs.length) {\r\n    (new Image()).src = \r\n      '//aud.pubmatic.com/AdServer/Artemis?dpid=14' +\r\n      '&segid=' + prvx_segs.join(',');\r\n  }\r\n})();\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "freq_cap": 3, "id": 27407, "internal": false, "method": "document", "name": "PubMatic Segment Sharing", "require": "", "target": "", "target_action": null, "tier": 10, "timing": "onload", "type": "publisher"}, {"content": "<img src='http://beacon.krxd.net/event.gif?event_id=IqzGIMAX&event_type=rtg&pub_id=54983c83-8810-4a6b-9ff1-81f7349ce967' width=0 height=0 />", "content_type": "html", "criteria": [{"name": "url", "operator": "contains", "value": "weather"}], "docwrite": null, "execution_results": null, "id": 26641, "internal": false, "method": "document", "name": "Weather Seekers", "require": "", "target": "", "target_action": null, "tier": 10, "timing": "onload", "type": "publisher"}, {"content": "<img src='http://beacon.krxd.net/event.gif?event_id=Itb2xiy1&event_type=rtg&pub_id=54983c83-8810-4a6b-9ff1-81f7349ce967' width=0 height=0 />", "content_type": "html", "criteria": [{"name": "url", "operator": "contains", "value": "the-voice"}], "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "id": 27291, "internal": false, "method": "document", "name": "The Voice Audience", "require": "", "target": "", "target_action": null, "tier": 10, "timing": "onload", "type": "publisher"}, {"content": "<script type='text/javascript' \r\n        src='//pixel.mathtag.com/sync/js?sync=auto'>\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "id": 28327, "internal": false, "method": "document", "name": "MediaMath User Match", "require": "", "target": "", "target_action": null, "tier": 10, "timing": "onload", "type": "publisher"}, {"content": "<script type=\"text/javascript\">\r\n  // Scrape dart\r\n  Krux('scrape.dart', {\r\n    page_attr_dart: \"sym,xa\".split(\",\")\r\n  });\r\n\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 13132, "internal": 1, "method": "document", "name": "Krux Scraper - sym and xa", "require": "", "target": "", "target_action": null, "tier": 2, "timing": "onready", "type": "publisher"}, {"content": "<script type=\"text/javascript\">\r\n  // Scrape dart\r\n  Krux('scrape.dart', {\r\n    page_attr_dart: \"aff,area,b,chan,daypart,genre,f,package,pkid,ref,season,sect,show,site,sport,sub,sub2,t,tag,type,pageid\".split(\",\")\r\n  });\r\n  // Set section/subsection\r\n  Krux('set', {\r\n    section: Krux('get', 'domain'),\r\n    subsection: Krux('get', 'page_attr_dart_sect')\r\n  });\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 10688, "internal": 1, "method": "document", "name": "Krux Scraper - Hierarchy and Attributes", "require": "", "target": "", "target_action": null, "tier": 2, "timing": "onready", "type": "publisher"}, {"content": "<script>var __nbcsnasadops={init:function(){if(!top.__nbcudigitaladops_header){return false}this.segfilter=['94118g','12053g','55053g','65151g','15112g','43118g'];this.h=top.__nbcudigitaladops_header;this.sc='snas';this.dc='snas_d';this.nic='snas_noinfo';this.drtp='ssg';this.s=this.h.gc(this.sc)||'';this.d=this.h.gc(this.dc)||'';this.ni=this.h.gc(this.nic)||'';this.u='';this.cookiesEnabled=document.cookie.length>0;if(this.ni){return false}if(this.d){this.populateDartTags();this.setLocalCookies()}else{if(this.s){this.u=this.extractUUID();this.getDemoByUUID()}else{this.getGlobal()}}},populateDartTags:function(){if(!this.d){return false}var demo=this.d.indexOf('%')>-1?unescape(this.d):this.d;var sdarr=demo.split(';');for(var i=0;i<sdarr.length;i++){for(var j=0;j<this.segfilter.length;j++){if(sdarr[i]==this.segfilter[j]){this.h.dtprm(this.drtp+'='+sdarr[i]+';')}}}},getGlobal:function(){var callback='__nbcsnasadops.doSCallback';var url='http://snas.nbcuni.com/snas/api/getRemoteDomainCookies?callback=';this.jsonp(url,callback)},doSCallback:function(j){if(!j||!j.cookie){return false}this.s=j.cookie[this.sc]||'';if(!this.s){this.setNoInfoCookie();return false}this.u=this.extractUUID();this.d=j.cookie[this.dc]||'';if(this.d){this.populateDartTags();this.setLocalCookies()}else{if(this.u){this.getDemoByUUID()}else{this.setNoInfoCookie()}}},getDemoByUUID:function(){var callback='__nbcsnasadops.doUCallback';var url='http://demographics.nbcuni.com/demographics/api/getFormattedPersonDemographics/';url+=this.u+'/bt-in-script/';this.jsonp(url,callback)},doUCallback:function(j){if(!j||!j.personDemographics){return false}var d=j.personDemographics||'';if(d){this.d=d;this.populateDartTags();this.setLocalCookies()}},extractUUID:function(){if(this.s.indexOf('data='>-1)){var uuid=this.s.replace(/.*data=(\\w+).*/i,\"$1\");return uuid}return''},setLocalCookies:function(){if(this.d&&(!this.h.gc(this.dc))){var demo=this.d.indexOf(';')>-1?escape(this.d):this.d;var d=new Date((new Date().valueOf())+2592000000).toUTCString();var c=this.dc+'='+demo+'; expires='+d+'; path=/;';document.cookie=c}if(this.s&&(!this.h.gc(this.sc))){var d=new Date((new Date().valueOf())+2592000000).toUTCString();var c=this.sc+'='+this.s+'; expires='+d+'; path=/;';document.cookie=c}return true},saveNBCUNIMetricsDataLocal:function(){},setNoInfoCookie:function(){var c=this.nic+'=1; expires=; path=/;';document.cookie=c},jsonp:function(src,cbk){var head=document.getElementsByTagName(\"head\")[0];var script=document.createElement(\"script\");script.src=src+=cbk;var done=false;script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState==\"loaded\"||this.readyState==\"complete\")){done=true;script.onload=script.onreadystatechange=null;head.removeChild(script)}};head.appendChild(script)}};__nbcsnasadops.init();</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 10957, "internal": false, "method": "document", "name": "Internal NBC Metrics: SNAS - (w/SegFilterActive)", "require": "", "target": "", "target_action": null, "tier": 5, "timing": "onready", "type": "publisher"}, {"content": "<script>\r\nif( top.__nbcudigitaladops_header ){\r\n        top.__nbcudigitaladops_header.fnc = function(){\r\n                var uuid = '';\r\n                var s = top.__nbcudigitaladops_header.gc('snas');\r\n                if(s.indexOf('data='>-1)){\r\n                        uuid = s.replace(/.*data=(\\w+).*/i,\"$1\");\r\n                }else{\r\n                        var sn_user = unescape(top.__nbcudigitaladops_header.gc('sn_nbc_b')).split('|');\r\n                        uuid = sn_user[1];\r\n                }\r\n                if( !uuid ){ return false; }\r\n                var rand = Math.round(Math.random()*1000000000000);\r\n                var snas_d = top.__nbcudigitaladops_header.gc('snas_d');\r\n                if(snas_d.indexOf('%')>-1){ snas_d = unescape(snas_d); }\r\n                var docurl = document.location.href+'';\r\n                var siteurlpieces = document.location.hostname.split('.');\r\n                var siteurl = siteurlpieces[siteurlpieces.length-2]+'.'+siteurlpieces[siteurlpieces.length-1];\r\n                var snasurl = 'http://snas.nbcuni.com/snas/api/saveActivity?URL='+escape(docurl);\r\n                snasurl += '&contentType=PAGE&personUUID='+uuid+'&siteName='+siteurl+'&siteDomainName='+siteurl;\r\n                snasurl += '&snas_d='+snas_d+'&rand='+rand;\r\n                document.write('<img src=\"'+snasurl+'\" width=\"1\" height=\"1\" />');\r\n        };\r\n        top.__nbcudigitaladops_header.fnc();\r\n}\r\n</script>", "content_type": "html", "docwrite": null, "execution_results": null, "id": 10971, "internal": false, "method": "document", "name": "Internal NBC Metrics: SNAS - saveActivity", "require": "", "target": "", "target_action": null, "tier": 10, "timing": "onready", "type": "publisher"}, {"content": "<script>\r\n  _qacct=\"p-9eJ8k4iSzux46\";\r\n</script>\r\n<script src=\"//secure.quantserve.com/quant.js\"></script>", "content_type": "html", "docwrite": null, "execution_results": {"docwrite": false, "listeners": [], "onloadSafe": true}, "id": 10993, "internal": false, "method": "document", "name": "Quantcast - Simple Tag", "require": "", "target": "", "target_action": null, "tier": 10, "timing": "onready", "type": "publisher"}]};

    // Wrap in a function and comment, then toString the func and replace
    // everything that's not the beginning or end of a JSON object, so we get a
    // string that's either empty or JSON.
    var esiGeo = String(function(){/*
      <esi:include src="/geoip_esi"/>
    */}).replace(/^.*\/\*[^{]+|[^}]+\*\/.*$/g, '');

    if (esiGeo) {
      config.geo = esiGeo;
    }

    Krux('config', config);
    
  };

  loadCT( "//cdn.krxd.net/ctjs/controltag.js.5435b19a49bbd367967a85852525d313", loadConfig );
})();
