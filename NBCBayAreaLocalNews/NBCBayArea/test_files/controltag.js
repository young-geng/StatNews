(function(){var o,y;(function(){var b=this,e={};o=function(b,a){o[b]=a};y=function(c){if(y[c]===e)throw"Circular require";if(!o[c])throw"Unknown require: "+c;return y[c]||(y[c]=e)&&(y[c]=new function(){return o[c](this,y,b)||this})}})();o("adm-events",function(b,e){var c=e("util"),a=e("store"),i=e("routes"),k=b.COOKIE_SERVICE_TTL=30*a.MINUTES,l=b.EVENT_TTL=2*a.DAYS,d=b.prefix="e_",g=b.knownEventIds=[];b.addEventId=function(a){c.contains(g,a)||g.push(a)};var m=b.parse=function(a){a=a.split("&");return{id:a.shift(),
attrs:c.parseKeyValues(a.join("&"))}},f=b.stringify=function(a){return a.id+"&"+c.paramString(a.attrs)},n=b.storeEvent=function(b,m){m=m||0;a.set(d+f(b),1,l-m)},q=b.processEvent=function(a){var b="event_"+a.id;c.set(b,!0);c.eachHash(a.attrs,function(a,h){var d=b+"_attr_"+a,d=c.get(d)||c.set(d,[]);c.contains(d,h)||d.push(h)})},j=b.readFromStore=function(){var b=a.namespace(d);c.eachHash(b,function(a){q(m(a))})},r=b.process3rdParty=function(a){var b=/^e_(.*)/,d;c.eachHash(a,function(h){if(d=h.match(b)){var f=
m(d[1].replace(/\^/g,"&").replace(/\|/g,"="));c.contains(g,f.id)&&(h=(new Date-new Date(parseInt(a[h],10)))/1E3,n(f,h),q(f))}})};b.check3rdParty=function(){g.length&&!a.get("event3p")&&e("http").jsonp({url:c.get("url_cookies")||"//beacon.krxd.net/cookie2json",callback:"kxjsonp_3pevents",done:function(d){a.set("event3p","1",k);r(d)}})};j();i.simple("admEvent",function(a,d){var b={id:a,attrs:d};n(b);q(b);e("http").pixel({url:c.get("url_event"),data:c.extend({event_id:a,pub_id:c.get("pubid")},d)})})});
o("class",function(b,e){var c=e("util"),a=b.beget=function(a,b){function e(){this.constructor=b}c.extend(b,a);e.prototype=a.prototype;b.prototype=new e;return b};(b.Class=c.extend(function(){var a=arguments;c.each(this._class.initializers,function(b,c){c.apply(this,a)},this)},{extensions:{extension:[/^extension_(.+)/,function(a,b){var e={};e[a[1]]=b;this.extensions=c.extend(this.extensions||{},e)}]},mixin:function(a){c.isFunction(a)?a(this):c.each(a,c.bind(this.mixinProperty,this))},mixinProperty:function(a,
b){var e;c.some(this.extensions,function(d,g){if(e=a.match(g[0]))return g[1].call(this,e,b)||!0},this)||(this.prototype[a]=b)}})).mixin({_bind:function(a){c.each(a.split(" "),function(a){this[a]=c.bind(this[a],this)},this)},_apply:function(a,b){this[a].apply(this,b)},_super:function(a,b){var e,d=this._superctx;this._superctx=(this._superctx||this)._superproto;c.isString(a)?e=this._superctx[a].apply(this,b||[]):this._superctx.constructor.apply(this,a||[]);this._superctx=d;return e},extension_classMethod:[/^__(.+)/,
function(a,b){this[a[1]]=b}],extension_initialier:[/^_init_(.+)/,function(a,b){var e={};e[a[1]]=b;this.initializers=c.extend(this.initializers||{},e)}],__extend:function(b){a(this,b).construct(this,c.rest(arguments,1));return b},__construct:function(a,b){this.prototype._superproto=a.prototype;this.prototype._class=this;if(!this.name){var e=this.toString().match(/function\s+([^\(]+)/);e&&(this.name=e[1])}c.each(b,function(a){this.mixin(a)},this);this.init()},__init:function(){}})});o("context-terms",
function(b,e,c){var a=e("util"),i=c.document,c="a form script noscript style select textarea button".split(" "),k=RegExp("<("+c.join("|")+")\\b","i"),l=RegExp("^("+c.join("|")+")$","i");b.process=function(b){for(var d=[i.body],f="",c;c=d.shift();)3===c.nodeType?f+=c.nodeValue:1===c.nodeType&&!l.test(c.nodeName)&&(k.test(c.innerHTML)?[].unshift.apply(d,a.toArray(c.childNodes)):f+=c.innerText||c.textContent);f=f.replace(/\s\s+/g," ");a.each(b,function(b){b.matches=0;var d=RegExp("\\b"+a.escapeRegexp(b.value)+
"\\b","ig");f.replace(d,function(){b.matches++})});b=a.filter(b,function(b){return a.set("context_term_"+b.id,b.matches)});a.set("context_terms_processed",!0);a.set("page_attr_kx_context_terms",b);a.set("context_terms",a.map(b,function(a){return a.id}));return{text:f,terms:b}};var d=e("pixel"),b=b.pixelFormatter=function(b){return a.map(b,function(a){return a.id+d.tuppleSeparator+a.matches}).join(",")};d.addFormatter("_kpa_kx_context_terms",b)});o("data-rewrite",function(b,e){var c=e("util"),a=e("expression"),
i=c.rewriter({country:"user_attr_kx_geo_country",sub_section:"subsection",segment:"user_segments"}),k=c.rewriter({"=":"is","!=":"isnt",before:"<",after:">"}),l=b.expression=function(b){var g=k(b.operator),m=i(b.name);c.isArray(b.value)?b="["+b.value.join(",")+"]":(b=b.value,b=String(b),b=b.match(/,/)?"["+b.split(", ").join(",")+"]":b);var f=function(a,b,d){return c.map(a,function(a){return[b,"$"+d,a]})},n=c.isArray(a.get(m)),e=a.parse(b);if(c.isArray(e)){if("is"===g&&(g=n?"intersects":"memberOf"),
"isnt"===g&&(g=n?"notIntersects":"notMemberOf"),"url"===m&&!n){if("contains"===g)return["or"].concat(f(e,g,m));if("notContains"===g)return["and"].concat(f(e,g,m))}}else n&&("is"===g&&(g="contains"),"isnt"===g&&(g="notContains"));return[g,"$"+m,b]};b.tag=function(a){a=c.extend({},a,{criteria:["and"].concat(c.map(a.criteria,l))});a.freq_cap&&a.criteria.push(["<","$tag_deliveries_today",a.freq_cap]);a.user_percent&&a.criteria.push(["<",["random"],a.user_percent/100]);delete a.rules;/^\s*\/\/@eval\b/.test(a.content)&&
(a.method="eval");a.name=a.name||"Anonymous";a.timing=a.timing||"onload";return a};a.setDelimiter("user_segments",",");b.contextTermExpression=function(a){if("is"===k(a.operator))var b=a.occurrences.min||1,a=["or"].concat(c.map(a.values.split(","),function(a){return[">=","$context_term_"+a,b]}));else a=["and"].concat(c.map(a.values.split(","),function(a){return["is","$context_term_"+a,0]}));return["and","$context_terms_processed",a]}});o("data",function(b,e,c){var a=e("util"),i=b.root={},k=b.defs=
{};a.get=b.get=function(a){return i[a.match(/_/)?a:"_"+a]};a.set=b.set=function(b,f){if(!a.isString(b))return a.each(b,a.set);b=b.match(/_/)?b:"_"+b;i[b]=f;a.fire("data:change",{key:b,value:f});return f};a.removeData=b.remove=function(a){delete i[a]};b.raw=function(){return i};var l=b.define=function(b,f){if(!a.isString(b))return a.each(b,l);k[b]=f},d=b.defaults=function(b,f){if(!a.isString(b))return a.each(b,d);var c=a.get(b);return null==c?a.set(b,f):c},g=b.namespace=function(b,c){var d=b+"_",g,
j=RegExp(d+"(.+)"),e=a.attributes({get:function(b){return a.get(d+b)},set:function(b,c){return a.set(d+b,c)},all:function(){var b={};a.eachHash(i,function(a,h){if(null!=(g=a.match(j)))b[g[1]]=h});return b},values:c}),l;e.change=function(b){l||(l=[],a.on("data:change",function(b){null!=(g=b.key.match(j))&&a.each(l,function(a){a(b)})}));l.push(b)};return e};b.user_attr=g("user_attr");b.page_attr=g("page_attr");e("routes").simple("set",a.set);e("routes").simple("get",a.get);e("routes").regexp(/data:(.+)/,
function(a,b){return g(a[1],b)});e=c.navigator;if(e=e.language||e.browserLanguage||e.userLanguage||e.systemLanguage)e=e.replace("_","-"),e=e.toLowerCase();b.user_attr("kx_lang",e);b.user_attr("kx_tech_browser_language",e)});o("dataprovider",function(b,e){var c=e("http"),a=e("util"),i=b.userMatch=function(b,d,g){c.pixel({url:a.get("url_um"),data:{partner:b,r:d,_kdpid:g}})},k=b.exelate=function(){i("exelate","//loadm.exelator.com/load/","e4942ff0-4070-4896-a7ef-e6a5a30ce9f9")};e("routes").simple("dataprovider.exelate",
k)});o("dom-iframe",function(b,e,c){var a=e("util"),i=function(b){this.options=a.extend({},k,b||{});this.node=e("dom").createElement("iframe",this.options.attr);this.insert();if(!this.options.attr.src||this.options.html)this.html(this.options.html||"")},k={target:null,targetAction:"append",html:"",attr:{}};i.prototype={insert:function(){var a=this.options,b=a.targetAction,a=a.target||c.document.body;e("dom").insert(b,a,this.node);this.win=i.window(this.node);this.doc=i.document(this.node)},html:function(a){var b=
this.doc;a.match(/^<html>/)||(a="<html><head></head><body>"+a+"</body></html>");b.open();b.write(a);b.close()}};i.window=function(a){return a.contentWindow};i.document=function(a){return i.window(a).document};b.IFrame=i});o("dom",function(b,e,c){function a(b,h,c){var f=b.tagName,s=b.attributes||{},b=b.children||[],h=h||[],c=c||0,d=m[f];h("<",f);l.each(s,function(a,b){h(" ",a,'="',b,'" ')});if(d)return h("/>");h(">");l.isString(b)?h(b):l.each(b,function(b){a(b,h,c+1)});d||h("</",f,">")}function i(b,
h,c){b=l.isString(b)?{tagName:b,attributes:h,children:c}:b;h=new q;a(b,h);return h.data()}function k(){try{g.documentElement.doScroll("left")}catch(a){d(k,1);return}l.fireOnce("dom:ready")}var l=e("util"),d=c.setTimeout;l.extend(b,e("dom-iframe"));var g=c.document,m=new l.Set("area base basefont br col frame hr img input isindex link meta param embed".split(" ")),f=b.attr=function(a,b){var h;try{return a.getAttribute(b)||null!=(h=a.attributes[b])&&h.value||""}catch(c){return""}},n=b.text=function(a){return a.innerText||
a.textContent};b.value=function(a){var b=a.nodeName;return"INPUT"===b?f(a,"value"):"TEXTAREA"===b&&n(a)};var q=b.StringStream=function(){function a(){b.push.apply(b,arguments);return a}var b=[];a.data=function(){return b.join("")};return a},j=b.createElement=function(){var a=i.apply(null,arguments),b=g.createElement("div");b.innerHTML=a;return b.childNodes[0]};b.create=j;var r=b.head=function(a){a=a||g;return a.head||a.getElementsByTagName("head")[0]};b.document=function(a){return a.document||a.ownerDocument||
a};b.window=function(a){a=b.document(a);return a.parentWindow||a.defaultView};var t=b.remove=function(a){a.parentNode.removeChild(a)};b.isNode=function(a){return!!a.nodeType};var p=b.before=function(a,b){a.parentNode.insertBefore(b,a)},u=b.append=function(a,b){a.appendChild(b)};b.after=function(a,b){var h=a.nextSibling;h?p(h,b):u(a.parentNode,b)};b.prepend=function(a,b){var h=a.firstChild;h?p(h,b):u(a,b)};b.insert=function(a,h,c){if(3===arguments.length)b[a](h,c);else{var c=a,f=g.getElementsByTagName("script")[0];
f.parentNode.insertBefore(c,f)}};b.replace=function(a,b){p(a,b);t(a)};b.scriptEval=function(a){var b=g.createElement("script");b.text=a;r(g).appendChild(b)};b.winEval=function(a,b){a.kxeval||(a.execScript?a.execScript("(function(){\n  var win = this;\n  win.kxeval = win.execScript ? \n    function(expr){return win.execScript(expr);} :\n    function(expr){return win.eval(expr);};\n})();"):a.eval("(function(){\n  var win = this;\n  win.kxeval = win.execScript ? \n    function(expr){return win.execScript(expr);} :\n    function(expr){return win.eval(expr);};\n})();"));
return a.kxeval(b)};b.childElements=function(a){var b=[];l.each(a.childNodes,function(a){1===a.nodeType&&b.push(a)});return b};b.onload=function(a,b){l.isFunction(b)&&(b={done:b});var h=l.once(b.done||l.doNothing),c=l.once(b.fail||l.doNothing),f=a.attachEvent?"attachEvent":"addEventListener",s=a.attachEvent?"on":"";l.each({load:h,error:c,readystatechange:function(){a.readyState&&a.readyState.match(/complete|loaded/)&&h()}},function(b,h){a[f](s+b,h,!0)})};var h=1,x=b.hash=function(a){return a._krux_hash||
(a._krux_hash=h++)},s={};b.meta=function(a){var b=x(a);return s[b]||(s[b]={node:a,hash:b})};j=c.navigator;b.ie=!!j.userAgent.match(/MSIE /);var v=b.ff=!!j.userAgent.match(/Firefox/);b.ua=j.userAgent.toLowerCase();var w=b.ua.match(/(webkit)[ \/]([\w.]+)/)||b.ua.match(/(opera)(?:.*version)?[ \/]([\w.]+)/)||b.ua.match(/(msie) ([\w.]+)/)||0>b.ua.indexOf("compatible")&&b.ua.match(/(mozilla)(?:.*? rv:([\w.]+))?/)||["unknown","unknown",0];b.browser=w[1];b.version=parseFloat((w[2]||"0").match(/^[0-9]+[.0-9]*/)[0],
10);b.msie="msie"===w[1];b.mozilla="mozilla"===w[1];b.webkit="webkit"===w[1];b.opera="opera"===w[1];b.gecko=-1!==b.ua.indexOf("gecko/");b.chrome=!!c.chrome;b.ie6=b.msie&&"6"===b.version;b.ie7=b.msie&&"7"===b.version;b.ie8=b.msie&&"8"===b.version;b.ie9=b.msie&&"9"===b.version;b.browserBucket=b.msie?"IE."+b.version:v?"Firefox."+(4>b.version?"3x":"4plus"):b.opera?"Opera":b.chrome?"Chrome":b.webkit?"Webkit":"Other";b.lang=(j.language||j.systemLanguage||j.browserLanguage||j.userLanguage||"").substring(0,
2);e("events");var z=!!c.window.attachEvent,B=b._on_=z?"attachEvent":"addEventListener",e=b.type={ready:{target:c.document},load:{target:c},unload:{target:c},beforeunload:{target:c}},A=b.on=function(a,b,h,c){b=(z?"on":"")+b;a[B](b,h,c||!1)};l.each(e,function(a,h){h.nativeName="ready"!==a?a:z?"readystatechanged":"DOMContentLoaded";b[a]=function(b){l.onOnce("dom:"+a,b)}});var o=function(a){return"load"!==a?function(){l.fireOnce("dom:"+a)}:function(){l.fireOnce("dom:ready");l.fireOnce("dom:load")}};
if(/^(complete|loaded)$/.test(c.document.readyState))o("load")();else{if(b.ie){A(c,e.load.nativeName,o("ready"));j=!1;try{j=null==c.window.frameElement}catch(C){}g.documentElement.doScroll&&j&&k()}l.each(e,function(a,b){A(b.target,b.nativeName,o(a),!1)})}d(l.bind(l.fireOnce,null,"dom:load",{timedout:!0}),6E3)});o("events",function(b,e){var c=e("util"),a=e("class").Class,a=b.Events=a.extend(function(){this._handlers={ALL:[]};this._happened={};this._super(arguments)},{on:function(a,b){if(c.isString(a))(this._handlers[a]||
(this._handlers[a]=[])).push(b);else if(c.isFunction(a))this._handlers.ALL.push(a);else this.on(function(c){a.test(c.type)&&b(c)})},off:function(a,b){this._handlers[a]=b?c.remove(this._handlers[a],b):[]},fire:function(a,b){b=b||{};b.type||(b.type=a);this._happened[a]=b;"data:change"!==b.type&&c.log(b);var d=function(a){a(b)};c.each(this._handlers[a],d);c.each(this._handlers.ALL,d);return b},onOnce:function(a,b){var d;return(d=this._happened[a])?c.defer(b,d):this.on(a,c.once(b))},fireOnce:function(a,
b){return!this._happened[a]&&this.fire(a,b)},onOnceAll:function(a,b){var a=a.split(" "),b=c.once(b),d=c.bind(function(){c.all(a,function(a){return this._happened[a]},this)&&b()},this);c.each(a,function(a){this.onOnce(a,d)},this)},happened:function(a){return this._happened[a]}}),i=b.instance=new a;i._bind("on off fire onOnce fireOnce onOnceAll happened");c.each("on off fire onOnce fireOnce onOnceAll happened".split(" "),function(a){c[a]=i[a]})});o("expression",function(b,e){var c=e("util"),a=c.isArray,
i=c.isString,k={},l={},d,g=b.get=function(a){var b=c.get(a),a=c.get(a+"DELIM");return c.isArray(b)?b:a?b?b.split(a):[]:b};b.setDelimiter=function(a,b){c.set(a+"DELIM",b)};var m=b.parse=function(a){var b;return!c.isString(a)?a:(b=a.match(/^\$(.*)/))?g(b[1]):(b=a.match(/^\[\s*(.*)\s*\]$/))?c.map(b[1].split(/\s*,\s*/),m):(b=a.match(/^"(.*)"$/))?b[1]:a},f=function(a){var b;b=(b=d(a[0]))&&(k[b]||l[b]);return b.apply(this,b.isMacro?c.rest(a):c.map(c.rest(a),d))};d=b.eval=function(b){return a(b)?f(b):i(b)?
m(b):b};c.extend(k,{is:function(a,b){return a===b},matches:function(a,b){return RegExp(b).test(a)},startsWith:function(a,b){return k.matches(a,"^"+c.escapeRegexp(b))},endsWith:function(a,b){return k.matches(a,c.escapeRegexp(b)+"$")},contains:function(a,b){var a=a||[],f=(""+b).toLowerCase();return c.isArray(a)?c.any(a,function(a){return(""+a).toLowerCase()===f}):0<=(""+a).toLowerCase().indexOf(f)},memberOf:function(a,b){return k.contains(b,a)},intersection:function(a,b){return c.intersection(a,b)},
intersects:function(a,b){a=c.isArray(a)?a:[a];b=c.isArray(b)?b:[b];return c.any(a,function(a){return k.contains(b,a)})},random:function(){return Math.random()},now:function(){return new Date}});c.each(["<",">","<=",">="],function(a){k[a]=new Function("a","b","return a "+a+" b")});c.extend(k,{isnt:c.negate(k.is),notMemberOf:c.negate(k.memberOf),notContains:c.negate(k.contains),notIntersects:c.negate(k.intersects)});c.extend(l,{and:function(){return c.every(arguments,d)},or:function(){return c.any(arguments,
d)}});c.each(l,function(a,b){b.isMacro=!0})});(function(){function b(b,d){var b=b||"",d=d||{},f;for(f in e)e.hasOwnProperty(f)&&(d.autoFix&&(d["fix_"+f]=!0),d.fix=d.fix||d["fix_"+f]);var n={comment:/^<\!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript)[\s>]/i,startTag:/^</,chars:/^[^<]/},q={comment:function(){var a=b.indexOf("--\>");if(0<=a)return{content:b.substr(4,a),length:a+3}},endTag:function(){var h=b.match(a);if(h)return{tagName:h[1],length:h[0].length}},atomicTag:function(){var a=
q.startTag();if(a){var h=b.slice(a.length);if(h.match(RegExp("</\\s*"+a.tagName+"\\s*>","i"))&&(h=h.match(RegExp("([\\s\\S]*?)</\\s*"+a.tagName+"\\s*>","i"))))return{tagName:a.tagName,attrs:a.attrs,content:h[1],length:h[0].length+a.length}}},startTag:function(){var a=b.match(c);if(a){var h={};a[2].replace(i,function(a,b,c,f,d){a=c||f||d||k.test(b)&&b||null;h[b]=a});return{tagName:a[1],attrs:h,unary:!!a[3],length:a[0].length}}},chars:function(){var a=b.indexOf("<");return{length:0<=a?a:b.length}}},
j=function(){for(var a in n)if(n[a].test(b)){l&&console.log("suspected "+a);var h=q[a]();return h?(l&&console.log("parsed "+a,h),h.type=h.type||a,h.text=b.substr(0,h.length),b=b.slice(h.length),h):null}};if(d.fix){var r=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,t=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i,p=[];p.last=function(){return this[this.length-1]};p.lastTagNameEq=function(a){var b=this.last();return b&&b.tagName&&b.tagName.toUpperCase()===
a.toUpperCase()};p.containsTagName=function(a){for(var b=0,h;h=this[b];b++)if(h.tagName===a)return!0;return!1};var u=function(a){a&&"startTag"===a.type&&(a.unary=r.test(a.tagName)||a.unary);return a},h=j,x=function(){b="</"+p.pop().tagName+">"+b},s={startTag:function(a){var h=a.tagName;"TR"===h.toUpperCase()&&p.lastTagNameEq("TABLE")?(b="<TBODY>"+b,v()):d.fix_selfClose&&t.test(h)&&p.containsTagName(h)?p.lastTagNameEq(h)?x():(b="</"+a.tagName+">"+b,v()):a.unary||p.push(a)},endTag:function(a){p.last()?
d.fix_tagSoup&&!p.lastTagNameEq(a.tagName)?x():p.pop():d.fix_tagSoup&&(h(),v())}},v=function(){var a=b,c=u(h());b=a;if(c&&s[c.type])s[c.type](c)},j=function(){v();return u(h())}}return{append:function(a){b+=a},readToken:j,readTokens:function(a){for(var b;(b=j())&&!(a[b.type]&&!1===a[b.type](b)););},clear:function(){var a=b;b="";return a},rest:function(){return b},stack:[]}}var e=function(){var a={},b=this.document.createElement("div");b.innerHTML="<P><I></P></I>";a.tagSoup="<P><I></P></I>"!==b.innerHTML;
b.innerHTML="<P><i><P></P></i></P>";a.selfClose=2===b.childNodes.length;return a}(),c=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,a=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,i=/([\-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,k=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i,l=!1;b.supports=e;b.tokenToString=function(a){var b={comment:function(a){return"<--"+
a.content+"--\>"},endTag:function(a){return"</"+a.tagName+">"},atomicTag:function(a){console.log(a);return b.startTag(a)+a.content+b.endTag(a)},startTag:function(a){var b="<"+a.tagName,c;for(c in a.attrs)var d=a.attrs[c],b=b+(" "+c+'="'+(d?d.replace(/(^|[^\\])"/g,'$1\\"'):"")+'"');return b+(a.unary?"/>":">")},chars:function(a){return a.text}};return b[a.type](a)};b.escapeAttributes=function(a){var b={},c;for(c in a){var d=a[c];b[c]=d&&d.replace(/(^|[^\\])"/g,'$1\\"')}return b};for(var d in e)b.browserHasFlaw=
b.browserHasFlaw||!e[d]&&d;this.htmlParser=b})();o("http-jsonp",function(b,e,c){var a=e("class").Class,i=e("util"),k=e("ns"),l=c.document,d={},g=b.Request=a.extend(function(a){a.data=a.data||{};this.options=a;if(!a.callback)throw"Callback name is required";i.extend(this,a);this.self&&(this.done=i.bind(this.done,this.self),this.fail=i.bind(this.fail,this.self));this.plantReceiver();this.src=e("http").src(this);this._class.all.push(this)},{fail:function(a){i.fire("error",{message:"jsonp failed with status "+
(a&&a.status||"unknown")+" src: "+this.src})},done:function(){},receive:function(a){this.time.end=new Date;return a.status?200==a.status?this.done(a.body):this.fail(a):this.done(a)},plantReceiver:function(){var a=this.options.callback;this.data.callback=k.path+"."+a;d[a]=d[a]||0;d[a]++;k.self[a]=i.bind(function(){d[a]--;0===d[a]&&delete k.self[a];this.receive.apply(this,arguments)},this)},sendInline:function(){l.write('<script src="'+this.src+'" type="text/javascript"><\/script>')},send:function(){this.time=
{start:new Date};if(this.inline)return this.sendInline();var a=l.createElement("script");a.type="text/javascript";a.src=this.src;var b=l.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b);return this},__all:[]});b.call=function(a){return(new g(a)).send()}});o("http",function(b,e,c){var a=e("util"),i=e("json").JSON,k=b.protocol="https:"===c.location.protocol?"https:":"http:",l=e("dom");b.maxUrlLength=l.msie?2048:8E4;var d=b.param=function(b,c){var d=a.isString(c)||a.isNumber(c)?c:i.stringify(c);
return encodeURIComponent(b)+"="+encodeURIComponent(d)},g=b.src=function(c){c.url=c.url||"no_url";var f=c.url;f.match(/^\/\//)&&(f=k+f);var g=a.map(c.data,d);if(!c.noClip)for(;(f+"?"+g.join("&")).length>b.maxUrlLength;)g.pop();return f+"?"+g.join("&")};b.willClip=function(c){c=b.src(a.extend({noClip:!0},c));return c.length>b.maxUrlLength&&c.length-b.maxUrlLength};b.pixel=function(b){try{(new c.Image).src=g(b),a.fire("http:pixel",b)}catch(d){}};b.jsonp=function(a){return e("http-jsonp").call(a)}});
o("index",function(b,e){e("init")});o("init",function(b,e,c){var a=c.location,i=c.document;var k=c.Krux||((c.Krux=function(){c.Krux.q.push(arguments)}).q=[]);if(!k.commit||k.ns)k.commit=k.commit||1,c.Krux=function(b,d){var g;d.params=d.params||{};g=d.params.control_tag_namespace;c.Krux=k;"string"===typeof d.geo&&(d.geo=e("json").JSON.parse(d.geo));var m=e("ns").init(g,function(){return e("routes").call});if(m){var f=e("util");m._=f;var n=new Date,q=e("dom");e("jslog");var j=e("data");j.user_attr=
j.namespace("user_attr");j.page_attr=j.namespace("page_attr");g=e("routes");var r={version:e("version").version,commit:e("version").commit,require:e,define:o,_:f};f.extend(m,r);m.isDefault&&f.extend(c.Krux,r);f.set("started",n);m=2;n=a.host.match(/^([^:]+)/)[1];n.match(/(?:\d{1,3}\.){3}\d{1,3}/)?m=void 0:(n=n.split(".").reverse(),n[1]&&n[1].match(/com?/)&&(m=3),m=n.slice(0,Math.min(m,n.length)).reverse().join("."));e("scrape");e("dataprovider");e("events");i.getElementById("kxinterchange")&&e("kxinterchange");
n=d.confid||"no-confid";q.kxhead=q.create("div",{"class":"kxhead","data-id":n,style:"display:none;"});q.insert(q.kxhead);var t=q.insert;q.insert=function(a){arguments.length===1?q.append(q.kxhead||q.head(i),a):t.apply(q,arguments)};f.set("confid",n);f.set("pubid",f.get("pubid")||d.publisher.uuid);f.set("domain",m);f.set("site",f.get("site")||d.site&&d.site.name||f.get("domain"));f.set("siteid",f.get("siteid")||d.site&&d.site.id);d.no_pii&&(f.set("pixel_data__knopii",1),j.user_attr("kx_lang",null),
j.user_attr("kx_tech_browser_language",null));e("pixel");e("test").init();e("test-visualtags").init();f.set("tags",d.tags);f.set("url",a.href);d.geo=d.geo||{};d.no_pii||f.each(["country","region","city","dma"],function(a){f.set("user_attr_kx_geo_"+a,d.geo[a.toUpperCase()])});f.set("config",d);f.set("version_bucket",d.params.control_tag_version);j.namespace("url",d.services);j.namespace("config_param",d.params);j=!/localStorage/.test(f.get("config_param_client_side_storage"));e("store").init(j);if(-1<
c.location.href.indexOf("krux_safe")||q.ie&&6>=q.version||q.gecko&&4>q.version||!i.readyState)c.console&&c.console.log("Krux running in safe mode, no tags will be delivered"),f.onOnce("dom:load",f.bind(f.fireOnce,null,"report"));else{j=f.map(f.get("tags"),e("data-rewrite").tag);f.set("tags",j);f.set("config_segments",d.realtime_segments);f.onOnceAll("dom:load tag:all_done",f.bind(f.fireOnce,null,"report"));e("adm-events").check3rdParty();e("stats");e("social");g.regexp(/^fire:(.+)/,function(a,b){return f.fire(a[1],
b)});g.regexp(/^on:(.+)/,function(a,b){return f.on(a[1],b)});g.regexp(/^fireOnce:(.+)/,function(a,b){return f.fireOnce(a[1],b)});g.regexp(/^onOnce:(.+)/,function(a,b){return f.onOnce(a[1],b)});g.regexp(/^require:?(.*)/,function(a,b){return a[1]?e(a[1]):b?e(b):e});g.simple("define",o);g.simple("JSON.stringify",e("json").JSON.stringify);g.simple("log",f.log);if(d.context_terms)f.onOnce("dom:load",function(){e("context-terms").process(d.context_terms)});e("tag")}}}});o("jslog",function(b,e,c){function a(a){d&&
c.console&&c.console.log("Error:",a);i.happened("jslog.pixel")?a.msg!==m[m.length-1]&&!(m.length>10*Math.random())&&(m.push(a.msg),a.type+="-postload",g.push(a),l.pixel(r()),g=[]):g.push(a)}var i=e("util"),k=e("dom"),l=e("http"),d=-1<c.location.search.indexOf("kxdebug"),g=[],m=[],f=b.errorTypes=["controltag","tag","test","js"],n=c.onerror||function(){return!1};c.onerror=function(b,d,f){try{if("string"!==typeof b)return n.apply(c,arguments);var h;var j=/https*:\/\/([^\/]+)\/([^?\/]+)/.exec(d);h=j&&
"apiservices.krxd.net"===j[1]?"service:"+j[2]:j&&-1<j[1].indexOf("krxd.net")?"controltag":"";a({type:h||"js",url:d,line:f,msg:b});return n.apply(c,arguments)}catch(s){c.console&&c.console.log("Error in the error handler",s)}return n.apply(c,arguments)};var q=b.sortByPriority=function(a){function b(a){a=i.indexOf(f,a.type);return-1!==a?a:f.length}return i.clone(a).sort(function(a,h){var c=b(a),d=b(h);return c<d?-1:c>d?1:0})};i.on("tag:fail",function(b){a({type:"tag",tagid:b.id,msg:b.error})});i.on("test:fail",
function(b){a({type:"test",msg:b.code+":"+b.data})});var j,r=b.getPixelOptions=function(a){for(var a=a||{url:i.get("url_log"),data:{control_tag_version:c.Krux.version,commit:c.Krux.commit,pubid:i.get("pubid"),siteid:i.get("siteid"),site_name:i.get("site"),browser_bucket:k.browserBucket,version_bucket:j,lang:k.lang,log_version:1.1,errors:q(g)}},b=a.data.errors;l.willClip(a)&&b.length;)b.pop();return a};i.on("test:all_done",function(){if(!(1>g.length)){var a=0;j=i.get("config_param_control_tag_version");
a="alpha"===j?1:0.1;Math.random()>a||(l.pixel(r()),i.fire("jslog.pixel",{errors:g.length}),g=[])}})});o("json",function(b,e,c){var a=e("util"),i,k,l,d,g=function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")+'"'};d=function(b){++l;b=l<=i&&a.isNull(b)?"null":a.isUndefined(b)?"null":a.isBoolean(b)?!0===b?"true":!1===b?"false":""+b:a.isString(b)?g(b):a.isNumber(b)?""+b:a.isArray(b)?"["+a.map(b,d).join(",")+"]":a.isArguments(b)?
"["+a.map(b,d).join(",")+"]":"{"+a.map(b,function(a,b){return(k?"\n"+Array(l+1).join("  "):"")+g(""+a)+":"+d(b)}).join(",")+(k?"\n"+Array(l+1).join("  "):"")+"}";--l;return b};b.myJSON={stringify:function(a,b){b=b||{};k=b.pretty||!1;i=b.maxdepth||15;l=0;return d(a)}};b.JSON=c.JSON||b.myJSON});o("kxinterchange",function(b,e,c){var b=function(a){var b,a="kx"+a;return((b=this.localStorage)?b[a]||"":(b=c.document.cookie)&&(b=b.match("\\b"+a+"=([^;]*)"))&&decodeURIComponent(b[1]))||""},a=e("util"),i=c.Krux,
k=i.user,l=i.segments,d=b("user"),g=b("segs");e("test").module("kxinterchange-support-snippet",function(b){b.eq("Krux.user exported",k,d);b.eq("Krux.segments exported",l,g&&g.split(",")||[]);a.each(l,function(a){b("Krux.dartKeyValues contains segment "+a,0<=i.dartKeyValues.indexOf("ksgmnt="+a))});d&&b("Krux.dartKeyValues contains user",0<=i.dartKeyValues.indexOf("u="+d))})});o("ns",function(b,e,c){var a=e("util"),e=c.Krux,i=/^ns:([\w\W]+)/,k=b.DEFAULT_NS="_default",l=b.parseArgs=function(b){var c=
b[0];(c=c.match(i))?(c=c[1],b=a.rest(b)):c=k;return{nsName:c,rest:b}},d;if(!(d=e.nsRouter)){var g=function(){var a=l(arguments),b=g.ns[a.nsName];if(!a.rest.length)return b;if(b)return b.apply(b,a.rest);g.q.push(arguments)};g.ns={};g.q=[];g.defineNamespace=function(b,c){var d=b||k;if(!g.ns[d]){var e=g.ns[d]=c(b);a.extend(e,{nsName:d,isDefault:d===k,path:"Krux.ns."+d});g.creator=g.creator||e;d=g.q;g.q=[];a.each(d,function(a){g.apply(null,a)});return e}};g.nsRouter=g;a.extend(g,e);d=c.Krux=g}b.router=
d;b.init=function(a,c){var d=b.self=b.router.defineNamespace(a,c);d&&(b.name=d.nsName,b.isDefault=d.isDefault,b.path=d.path);return d}});o("pixel",function(b,e,c){var a=e("util"),i=e("http"),k=e("dom"),l=e("data"),d=e("store"),g=c.Krux,m=b.sendImpl=function(b){var c={};a.eachHash(b,function(a,b){if(b=j(a,b))c[a]=b});var b=a.get("config_param_control_tag_pixel_throttle"),h=100*Math.random();b&&b<h||i.pixel({url:a.get("url_pixel"),data:c})},f=b.stringifyValue=function(b){return null!=b&&(a.isArray(b)?
a.map(b,f).join(r):b.toString())},n=b.formatters=[],q=b.addFormatter=function(a,b){n.push({test:a,formatter:b})},j=b.format=function(b,c){var h=a.find(n,function(h){return a.isString(h.test)?h.test===b:h.test.test(b)});return(h?h.formatter:f)(c)};b.tuppleSeparator=":";var r=b.arraySeparator=",",t=a.once(function(b){var j={source:"smarttag",fired:b,confid:a.get("confid"),_kpid:a.get("pubid"),_kcp_s:a.get("site"),_kcp_sc:a.get("section"),_kcp_ssc:a.get("subsection"),_kcp_d:a.get("domain"),_knifr:c.frames.length,
_kpref_:c.document.referrer};1!==a.get("pixel_data__knopii")&&(j.geo_country=a.get("user_attr_kx_geo_country"),j.geo_region=a.get("user_attr_kx_geo_region"),j.geo_city=a.get("user_attr_kx_geo_city"),j.geo_dma=a.get("user_attr_kx_geo_dma"));a.get("config_segments")&&a.get("config_segments").length&&(j.rtsegs=e("segments").realtime());var h=function(b,h){a.eachHash(h,function(a,h){j[b+a]=h})};h("_kua_",l.user_attr());h("_kpa_",l.page_attr());h("",l.namespace("pixel_data")());var f=c.performance,s=f&&
f.navigation,v=f&&f.timing;s&&(v&&!(k.gecko&&9>k.version))&&(f=function(a,b){if(!b){b=a+"End";a=a+"Start"}var h=v[a]&&v[b]&&v[b]-v[a];return h==null||h<0||h>3E4?-1:h},a.extend(j,{t_navigation_type:s.type,t_dns:f("domainLookup"),t_tcp:f("connect"),t_http_request:f("request"),t_http_response:f("response"),t_content_ready:f("navigationStart","domInteractive"),t_window_load:f("navigationStart","loadEventStart"),t_redirect:f("redirect")}));var s=e("scrape"),f=a.happened("user_data_response"),r=e("ns"),
r=r.isDefault?g:g[r.name]||{};a.extend(j,{interchange_ran:r.hasOwnProperty("user"),store_user:r.user,store_segs:r.segments,dart_user:s.dart("u"),dart_segs:s.dart("ksgmnt")||s.dart("ksg"),userdata_was_requested:!!a.happened("user_data_request"),userdata_did_respond:!!f,store_user_after:d.get("user"),store_segs_after:d.get("segs")});f&&a.extend(j,{userdata_user:[f.kuid,f.kuid_long],userdata_segs:f.segments});a.each({user:"_kua_",page:"_kpa_"},function(b,h){a.each(l[b+"_attr"](),function(a,b){j[h+a]=
b})});if(s=c.sessionStorage)try{j.sview=s.krux_views=+(s.krux_views||0)+1}catch(n){}s=a.get("tags");s=a.filter(s,function(a){return a.time&&a.time.end});a.each(s,function(a,b){h("kplt"+b,a.id);h("tag"+a.id+"_timing",{duration:a.time.duration})});q(/tag.*_timing/i,function(){return false});j.jsonp_requests=a.map(e("http-jsonp").Request.all,function(a){return[a.url,a.time.end-a.time.start]});m(j);a.fireOnce("pixel",{phase:b,data:j})});a.onOnce("report",function(){a.happened("user_data_fetch_scheduled")?
(a.onOnce("user_data_response",function(){t("report")}),c.setTimeout(function(){t("user_data_timeout")},300)):t("report")});a.onOnce("dom:beforeunload",function(){t("dom:beforeunload")});a.onOnce("dom:unload",function(){t("dom:unload")});a.on("navigation",function(b){b={source:"smarttag",type:"navigation",_kpid:a.get("pubid"),_kcp_s:a.get("site"),_kcp_sc:b.section,_kcp_ssc:b.subsection};m(b)});e("test").module("pixel",function(b){b("pixel",a.happened("pixel"))})});(function(){function b(){}function e(a,
b,c){var d,j=a&&a.length||0;for(d=0;d<j;d++)b.call(c,a[d],d)}function c(a,b,c){for(var d in a)a.hasOwnProperty(d)&&b.call(c,d,a[d])}function a(a,b){c(b,function(b,h){a[b]=h});return a}function i(a){try{return l.call(a)}catch(b){var c=[];e(a,function(a){c.push(a)});return c}}var k=this;if(!k.postscribe){var l=Array.prototype.slice,d=function(a,b,c){var d=m+b;if(2===arguments.length)return d=a.getAttribute(d),null==d?d:String(d);null!=c&&""!==c?a.setAttribute(d,c):a.removeAttribute(d)},g=function(b,
h){var c=b.ownerDocument;a(this,{root:b,options:h,win:c.defaultView||c.parentWindow,doc:c,parser:k.htmlParser("",{autoFix:!0}),actuals:[b],proxyHistory:"",proxyRoot:c.createElement(b.nodeName),scriptStack:[],writeQueue:[]});d(this.proxyRoot,"proxyof",0)},m="data-ps-";g.prototype.write=function(){[].push.apply(this.writeQueue,arguments);for(var a;!this.deferredRemote&&this.writeQueue.length;)a=this.writeQueue.shift(),"function"===typeof a?this.callFunction(a):this.writeImpl(a)};g.prototype.callFunction=
function(a){var b={type:"function",value:a.name||a.toString()};this.onScriptStart(b);a.call(this.win,this.doc);this.onScriptDone(b)};g.prototype.writeImpl=function(a){this.parser.append(a);for(var b,a=[];(b=this.parser.readToken())&&!/^script$/i.test(b.tagName);)a.push(b);this.writeStaticTokens(a);b&&this.handleScriptToken(b)};g.prototype.writeStaticTokens=function(a){a=this.buildChunk(a);if(a.actual)return a.html=this.proxyHistory+a.actual,this.proxyHistory+=a.proxy,this.proxyRoot.innerHTML=a.html,
this.walkChunk(),a};g.prototype.buildChunk=function(a){var b=this.actuals.length,c=[],d=[],j=[];e(a,function(a){c.push(a.text);if(a.attrs){if(!/^noscript$/i.test(a.tagName)){var f=b++;d.push(a.text.replace(/(\/?>)/," "+m+"id="+f+" $1"));"ps-script"!==a.attrs.id&&j.push("atomicTag"===a.type?"":"<"+a.tagName+" "+m+"proxyof="+f+(a.unary?"/>":">"))}}else d.push(a.text),j.push("endTag"===a.type?a.text:"")});return{tokens:a,raw:c.join(""),actual:d.join(""),proxy:j.join("")}};g.prototype.walkChunk=function(){for(var a,
b=[this.proxyRoot];null!=(a=b.shift());){var c=1===a.nodeType;if(!c||!d(a,"proxyof"))c&&(this.actuals[d(a,"id")]=a,d(a,"id",null)),(c=a.parentNode&&d(a.parentNode,"proxyof"))&&this.actuals[c].appendChild(a);b.unshift.apply(b,i(a.childNodes))}};g.prototype.handleScriptToken=function(a){var b=this.parser.clear();b&&this.writeQueue.unshift(b);a.src=a.attrs.src||a.attrs.SRC;if(a.src&&this.scriptStack.length)this.deferredRemote=a;else this.onScriptStart(a);var c=this;this.writeScriptToken(a,function(){c.onScriptDone(a)})};
g.prototype.onScriptStart=function(a){a.outerWrites=this.writeQueue;this.writeQueue=[];this.scriptStack.unshift(a)};g.prototype.onScriptDone=function(a){a!==this.scriptStack[0]?this.options.error({message:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,a.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this.onScriptStart(this.deferredRemote),this.deferredRemote=null))};g.prototype.writeScriptToken=function(a,b){var c=this.buildScript(a),
d=this.shouldRelease(c),j=this.options.afterAsync;a.src&&(c.src=a.src,this.scriptLoadHandler(c,!d?function(){b();j()}:j));try{this.insertScript(c),(!a.src||d)&&b()}catch(f){this.options.error(f),b()}};g.prototype.buildScript=function(a){var b=this.doc.createElement(a.tagName);c(a.attrs,function(a,c){b.setAttribute(a,c)});a.content&&(b.text=a.content);return b};g.prototype.insertScript=function(a){this.writeImpl('<span id="ps-script"/>');var b=this.doc.getElementById("ps-script");b.parentNode.replaceChild(a,
b)};g.prototype.scriptLoadHandler=function(b,c){function d(){b=b.onload=b.onreadystatechange=b.onerror=null;c()}var j=this.options.error;a(b,{onload:function(){d()},onreadystatechange:function(){/^(loaded|complete)$/.test(b.readyState)&&d()},onerror:function(){j({message:"remote script failed "+b.src});d()}})};g.prototype.shouldRelease=function(a){return!/^script$/i.test(a.nodeName)||!(!this.options.releaseAsync||!a.src||!a.hasAttribute("async"))};var f,n=function(){var a=t.shift();a&&(a.stream=q.apply(null,
a))},q=function(c,h,d){function f(a){a=d.beforeWrite(a);p.write(a);d.afterWrite(a)}p=new g(c,d);p.id=r++;p.name=d.name||p.id;j.streams[p.name]=p;var e=c.ownerDocument,q={write:e.write,writeln:e.writeln};a(e,{write:function(){return f(i(arguments).join(""))},writeln:function(a){return f(i(arguments).join("")+"\n")}});var m=p.win.onerror||b;p.win.onerror=function(a,b,c){d.error({msg:a+" - "+b+":"+c});m.apply(p.win,arguments)};p.write(h,function(){a(e,q);p.win.onerror=m;d.done();p=null;n()});return p},
j=function(a,d,j){"function"===typeof j&&(j={done:j});var f=j,j={releaseAsync:!1,afterAsync:b,done:b,error:function(a){throw a;},beforeWrite:function(a){return a},afterWrite:b},f=f||{};c(j,function(a,b){null==f[a]&&(f[a]=b)});var j=f,a=/^#/.test(a)?k.document.getElementById(a.substr(1)):a.jquery?a[0]:a,e=[a,d,j];a.postscribe={cancel:function(){e.stream?e.stream.abort():e[1]=b}};t.push(e);p||n();return a.postscribe},r=0,t=[],p=null;f=a(j,{streams:{},queue:t,WriteStream:g});k.postscribe=f}})();o("routes",
function(b,e,c){var a=e("util"),i=b.routes=[],k=b.q=c.Krux&&c.Krux.q||[],l=b.getHandler=function(b){return a.find(i,function(a){return a[0].test(b)})},d=b.call=function(b){if(a.isFunction(b))return b.call(null,e);var c=l(b);if(c)return c[1].apply(null,arguments);k.push(a.toArray(arguments))},c=b.understands=function(a){return!!l(a)},g=b.replay=function(){var b=a.clone(k);k.length=0;a.each(b,function(a){d.apply(null,a)})},m=b.add=function(a,b){i.push([a,b]);g()},f=b.regexp=function(b,c){m(b,function(d){return c.apply(this,
[d.match(b)].concat(a.rest(arguments)))})},n=b.simple=function(b,c){f(RegExp("^"+b+"$"),function(){return c.apply(null,a.rest(arguments))})};b.once=function(c,d){var f=function(){i=b.routes=a.remove(i,f);return d.apply(this,arguments)};n(c,f)};b.namespace=function(b,c){f(RegExp("^"+b+"\\.(.*)"),function(b){c[b[1]].apply(c,a.rest(arguments))})};n("understands",c)});o("scrape",function(b,e,c){var a=e("util"),i=e("data"),k=e("sizzle"),l=e("routes"),d=e("dom"),g=b.defaultExcludes="sz dcopt ord tile pos uri click ksgmnt null undefined".split(" "),
m=b._dart=function(){function d(a){return k.find("script[src*="+f+"]",a).concat(k.find("iframe[src*="+f+"]",a))}var f=".doubleclick.net",e={},g=[],g=g.concat(d(c.document)),n=k.find("iframe[src*=://"+c.location.hostname+"]").concat(k.find("iframe[src^=/]"));a.each(n,function(a){try{g=g.concat(d(a.contentWindow.document))}catch(b){}});b.dartElements=g;a.each(g,function(b){var c,b=(c=k.attr(b,"src").match(/[^;]*;(.*)/))&&c[1];c=a.parseKeyValues(b,";");a.eachHash(c,function(b,c){var d=e[b];d&&d!==c?
(a.isArray(d)||(d=[d]),a.isArray(c)?d=d.concat(c):d.push(c),e[b]=a.uniq(d)):e[b]=c})});if(g[0]){var h,n=(h=k.attr(g[0],"src").match(/\.doubleclick\.net(\/[^;]*)/))?h[1]:"";i.page_attr({dfpsite:n.split("/")[2],dfpzone:n.split("/")[3]})}return e},f,n=b.extensions={},e=b.extension=function(a,c){n[a]=b[a]=c;l.simple("scrape."+a,c);return c};a.eachHash({dart:function(b){f=f||m();var c=new a.Set(b&&b._excludes||g);return null==b?f:a.isString(b)?f[b]:a.eachHash(b,function(b,d){var j=i.namespace(b);a.isArray(d)?
a.each(d,function(a){f[a]&&j(a,f[a])}):"*"===d?a.eachHash(f,function(a,b){c[a]||j(a,b)}):a.set(b,f[d])})},dom:function(a){var b=a.match(/^(.+):([^:]+)$/),a=k.find(b[1])[0],b=b[2];return a&&b&&("text"===b?d.text(a):"value"===b?d.value(a):"@"===b.charAt(0)&&d.attr(a,b.substr(1)))},link_rel:function(a){return b.dom("link[rel="+a+"]:@href")},link_rev:function(a){return b.dom("link[rev="+a+"]:@href")},meta_name:function(a){return b.dom("meta[name="+a+"]:@content")},meta_property:function(a){return b.dom("meta[property="+
a+"]:@content")},opengraph:function(a){return b.meta_property("og:"+a)},url_path:function(a){return b.location.pathname.split("/")[a]},url_param:function(a){var c;return(c=b.location.href.match("\\b"+a+"(?:=|\\b)([^&]*)"))&&(decodeURIComponent(c[1])||!0)},url_host:function(a){return b.location.hostname.split(".").reverse()[a-1]},url_domain:function(c){return a.last(b.location.hostname.split("."),c).join(".")},cookie:function(a){var b;return(b=c.document.cookie)&&(b=b.match("\\b"+a+"=([^;]*)"))&&decodeURIComponent(b[1])},
data:function(b){return a.get(b)},javascript:function(b){try{return c.eval(b)}catch(d){a.fire("error",d)}},js_global:function(a){try{for(var b=c,d=a.split(".");b&&d[0];)b=b[d.shift()];return b}catch(f){}}},e);b.location=c.location;var q=b.scrape=function(b){var c={};a.eachHash(b,function(d,f){var e=a.findHash(f,function(a){return n[a]&&a});if(!e)return a.fire("error",{message:"No extension found",scrape:b});e=n[e](f[e]);c[d]=e});return c};l.simple("scrape",function(b){b=q(b);a.set(b);return b})});
o("segments",function(b,e){var c=e("util"),a=e("store"),i=e("data"),k=c.param("segs");k&&c.set("user_segments",k.split(","));var l=b.allRealtime=c.pluck(c.get("config_segments"),"id"),d=e("expression").eval,g=b.realtime=function(){for(var b=[],f=c.get("config_segments")||[],e=24*a.HOURS,g=0,n=f.length,h;g<n;++g)h=f[g],d(h.test)&&(a.set("rt_"+h.id,"1",e),b.push(h.id));return b},m=b.compute=function(){if(!k){var b=(b=a.get("segs"))?b.split(","):[],b=c.difference(b,l);c.set("user_segments",b);b=g().concat(b);
c.set("user_segments",b);a.set("segs",b.join(","))}},f=b.handleUserDataResponse=function(b){b.segments&&a.set("segs",b.segments.join(","),72*a.HOURS);b.prvx_segments&&(a.set("prvx_segs",b.prvx_segments.join(","),72*a.HOURS),c.set("user_prvx_segments",b.prvx_segments));b.shared_segments&&(a.set("shared_segments",b.shared_segments.join(","),72*a.HOURS),c.set("user_shared_segments",b.shared_segments));b.kuid&&(a.set("user",b.kuid,180*a.DAYS),c.set("user",b.kuid));b.technographics&&(a.set("tech",c.paramString(b.technographics),
30*a.DAYS),n());m();c.fire("user_data_response",b)},n=b.readTechFromStore=function(){var b=a.get("tech");return b?(1!==c.get("pixel_data__knopii")&&c.eachHash(c.parseKeyValues(b),function(a,b){c.set("user_attr_kx_tech_"+a,b)}),!0):!1},q={url:c.get("url_userData"),data:{pubid:c.get("pubid")},callback:"kxjsonp_userData",done:f};n()||(q.data.technographics=1);f=b.fetch=function(){c.fireOnce("user_data_request");e("http").jsonp(q)};c.get("segWait")||(c.set("segWait",1,5*a.MINUTES),c.onOnce("dom:load",
f),c.fire("user_data_fetch_scheduled"));a.get("segs");m();f=[];a.get("prvx_segs")&&(f=a.get("prvx_segs").split(","));c.set("user_prvx_segments",f);f=[];a.get("shared_segments")&&(f=a.get("shared_segments").split(","));c.set("user_shared_segments",f);f=c.throttle(m,100);i.user_attr.change(f);i.page_attr.change(f);i.namespace("event").change(m);e("test").module("segments",function(a){c.happened("user_data_fetch_scheduled")&&a("user_data_response",c.happened("user_data_response"))})});o("sizzle",function(b,
e,c){var a=e("util"),i=/^(?:(\w+)|(\*(?=\W|$))|\.([\w\-]+)|#([\w\-]+))([#\.\w\-]*)/,k=/^\[(\w+)(?:(\W?=)(["']?)([^\]]*)\3)?\]/,l=b.attr=function(a,b){var c;try{return a.getAttribute(b)||(c=a.attributes[b])&&c.value||""}catch(d){return""}},d=b.hasAttr=function(a,b){var c;return a.hasAttribute?a.hasAttribute(b):!(!(c=a.attributes[b])||!c.nodeValue)},g=function(b,c,e,g){var m=function(a){return function(b){return!!l(b,c).match(a)}},i=g&&a.escapeRegexp(g),e=!e?function(a){return d(a,c)}:"="===e?function(a){return l(a,
c)===g}:"!="===e?function(a){return l(a,c)!==g}:"*="===e?function(a){return 0<=l(a,c).indexOf(g)}:"~="===e?m("(^|\\s)"+i+"(\\s|$)"):"|="===e?m("^"+i+"\\b"):"$="===e?m(i+"$"):"^="===e?m("^"+i):"false";return a.filter(b,e)},m=b.getElementsByClassName=function(b,d){a.isString(b)&&(d=b,b=c.document);return b.getElementsByClassName?b.getElementsByClassName(d):g(b.getElementsByTagName("*"),"class","~=",d)};b.find=function(b,d){d=d||c.document;a.isArray(d)||(d=[d]);for(var e=d,j=[],l,t=0,p=function(b,c){return c[1]?
a.toArray(b.getElementsByTagName(c[1])):c[2]?a.toArray(b.getElementsByTagName("*")):c[3]?a.toArray(m(b,c[3])):c[4]&&(c=b.getElementById(c[4]))?[c]:[]},o=function(){j=j.concat(e===d?[]:e);e=d},h=function(a,b){return function(){var c=l.match(a);if(!c)return 0;b(c);return c[0].length}},x=h(i,function(b){var c=[];a.each(e,function(a){c=c.concat(p(a,b))});e=c;for(var d,h=b[5]||"";d=h.match(/^([\.#])([\w\-]+)/);)e="."===d[1]?g(e,"class","~=",d[2]):g(e,"id","=",d[2]),h=h.slice(d[0].length);if(h)throw"parse error";
}),s=h(k,function(a){e=g(e,a[1],a[2],a[4])}),v=h(/\s*/,function(){}),h=h(/,/,o);l=b.slice(t);){var w;if(!(w=x()))if(!(w=s()))if(!(w=h()))if(!(w=v()))throw"selector parse error";t+=w}o();return j}});o("social",function(b,e,c){var a=e("util");a.on("social",function(b){var g=a.rewriter({facebook:"fb",twitter:"twttr"});e("http").pixel({url:a.get("url_social"),data:{_kpid:a.get("pubid"),_kcp_s:a.get("site"),_ksoc_t:g(b.provider),_ksoc_e:b.action,_ksoc_url:b.url,_kpa_title:c.document.title}})});var i=function(b,
c){a.fire("social",{provider:"facebook",action:b,url:c})},k=b.init_facebook=function(){var b=(b=c.FB)&&(b=b.Event)&&b.subscribe&&a.bind(b.subscribe,b);b?(b("edge.create",a.bind(i,null,"like")),b("edge.remove",a.bind(i,null,"unlike")),b("message.send",a.bind(i,null,"send")),b="done"):b="fail";a.fire("social.init_facebook",{status:b})},l=b.init_twitter=function(){var b=(b=c.twttr)&&(b=b.events)&&b.bind&&a.bind(b.bind,b);b?(b("tweet",function(b){a.fire("social",{provider:"twitter",action:"tweet",url:b&&
b.target&&"IFRAME"===b.target.nodeName?b.target.src:null})}),b="done"):b="fail";a.fire("social.init_twitter",{status:b})};e("routes").simple("social.init",function(){c.setTimeout(function(){k();l()},1E3)})});o("stats",function(b,e){var c=e("util");e("events");e("data");var a={counter:{},time:{}},i=b.get=function(b,c){return a[b][c]},k=b.set=function(b,c,d){a[b][c]=d};b.time=function(a,b){k("time",a,b)};var l=b.inc=function(a){var b=i("counter",a)||0;k("counter",a,b+1)},d=b.incPath=function(a){var b=
a.split(".");c.times(b.length,function(a){l(c.first(b,a+1).join("."))})},g="."+e("dom").browserBucket,m="."+c.get("config_param_control_tag_version"),f=m+g;d("views"+f);c.get("config_param_control_tag_stats_prefix");c.on("social",function(a){l(a.provider+"."+a.action)});c.on("tag:done",function(){d("tags_delivered"+f)});var n=0;c.on("error",function(){try{10<n||(n++,d("js_errors"+f))}catch(a){}});if(Math.random()<(".alpha"===m?1:".beta"===m||".stable"===m?0.01:0.001))c.onOnce("tag:all_done",function(){function b(a,
c){return"controltagv2."+a+":"+c+"|"+this}var d=c.map(a.counter,c.bind(b,"c")).concat(c.map(a.time,c.bind(b,"ms"))).join(",");e("http").pixel({url:c.get("url_stats"),data:{q:d,format:"gif"}})})});o("store",function(b,e,c){var a=e("util"),i=c.localStorage,k=c.document,l=["set","get","remove","namespace"],d=b.SECONDS=1,d=b.MINUTES=60*d,d=b.HOURS=60*d;b.DAYS=24*d;var g={domain:function(a){return"; domain="+a}},m=b.cookie={set:function(a,b,c,d){c=c?"; expires="+(new Date(+new Date+1E3*c)).toUTCString():
"";a=a+"="+encodeURIComponent(b)+m._optionsToCookie(d)+";path=/"+c;return k.cookie=a},get:function(a){var b;return k.cookie&&(b=k.cookie.match("\\b"+a+"=([^;]*)"))&&c.decodeURIComponent(b[1])},remove:function(a){this.set(a,0,-1)},namespace:function(a){var b={};k.cookie.replace(RegExp("\\b"+a+"([^=]*)=([^;]*)","g"),function(a,c){b[decodeURIComponent(a)]=decodeURIComponent(c)});return b},_optionsToCookie:function(b){var c="";a.forEach(b,function(a,b){a in g&&(c+=g[a](b))});return c}};if(d=i){var f=
{set:function(a,b,c){i.setItem(a,b);c&&i.setItem("_"+a,+new Date(+new Date+1E3*c))},get:function(a){var b=i.getItem(a),a=i.getItem("_"+a);return!a?b:a>new Date?b:null},remove:function(a){i.removeItem(a);i.removeItem("_"+a)},namespace:function(a){var c={},d,e;for(e in i)if(d=e.match("^"+a+"(.*)"))c[d[1]]=b.get(d[1]);return c}},n={};a.each(l,function(a){n[a]=function(){try{return f[a].apply(f,arguments)}catch(b){}}});d=n}var q=b.local=d,e=e("ns"),j=b.prefix="kx"+(e.isDefault?"":e.name+"_");b.init=function(c){var d;
if(q&&!c)try{q.set("kxtest","test"),d="test"===q.get("kxtest")&&q,q.remove("kxtest")}catch(e){}var f=d=d||m,h={};a.each(l,function(b){h[b]=function(c){return f[b].apply(f,[j+(c||"")].concat(a.rest(arguments)))}});var g=b.impl=h;a.each(l,function(a){b[a]=g[a]})}});o("tag-delivery",function(b,e,c){var a=e("util"),i=e("dom"),k=c.document,l=e("store"),d=new Date,d=new Date(+d+864E5),g=new Date(d.getFullYear(),d.getMonth(),d.getDate()),m=b.mode="1"===a.param("writeCapture")?"writeCapture":"1"===a.param("writeNativeIframe")?
"nativeIframe":"1"===a.param("writeOld")?"old":"newWriter",f=function(a,b,d,h){a.root=b;var e=o(a.content);"writeCapture"===m?(c.$(b).attr("data-writeCapture","true"),c.$(b).writeCapture().html(e,{done:d})):"nativeIframe"===a.method||"native"===m&&a.target?b.ownerDocument.write(e):c.postscribe(b,e,{name:a.name,releaseAsync:!0,done:d,error:h})};e("routes").simple("nativeTag",function(c){"native"===m&&b.deliver(a.get("tagsByName")[c])});e("routes").simple("writeHtml",function(a,c,d){b.deliver({name:d||
"Anonymous",content:c,target:a[0]||a})});var n=function(a,b){var c;if(a.target){c=a.target;var d;c=c&&c.nodeType?c:c&&(d=c.match(/^(head|body)$/))?k[d[1]]:k.getElementById(c)}else c=i.kxhead||k.getElementsByTagName("script")[0].parentNode;if(d=c)i[a.target_action||"append"](d,b);return d},q=function(a){var b={"class":"kxtag","data-id":a.id,"data-alias":a.name};b["class"]+=a.target?" kxtargeted":" kxinvisible";return b},j={eval:function(b,c,d){var h;try{h=a.globalEval(b.content)}catch(e){d(e)}c();
return h},apply:function(a,b,c){var d;try{d=a.content.apply(null)}catch(h){c(h)}b();return d},document:function(a,b,c){var d=i.createElement("span",q(a));n(a,d)?f(a,d,b,c):b();return d},iframeCommon:function(a,b,d,h){var e=q(a);e.width=e.height=0;e.scrolling="no";e.style="overflow:hidden;";var g=a.name.match(/(\d+)x(\d+)/);g&&(e.width=g[1]+"px",e.height=g[2]+"px");e=i.createElement("iframe",e);if(n(a,e)){g=e.contentWindow.document;g.open();g.write('<html><head></head><body style="margin:0;">');h.leaveOpen||
g.close();if(h.onIframe)h.onIframe(e);e.contentWindow.Krux=c.Krux;f(a,e.contentWindow.document.body,b,d)}else b();return e},nativeIframe:function(a,b,c,d){d.leaveOpen=!0;return j.iframeCommon(a,b,c,d)},iframe:function(a,b,c,d){return j.iframeCommon(a,b,c,d)}},r=b.templateData=function(){return{pubid:a.get("pubid"),site:a.get("site"),geo:a.get("geo"),now:new Date}},o=b.runTemplate=function(b,c){e("underscore").templateSettings={evaluate:/\{%([\s\S]+?)%\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g,escape:/\{%-([\s\S]+?)%\}/g};
r.now=new Date;return a.template(b,c||r())},p=b.meetsCriteria=function(b){if(!b.criteria)return b.metCriteria=!0;if("native"===m&&b.target)return b.metCriteria=!1;a.set("now",new Date);if(b.freq_cap){var c=+l.get("tag"+b.id+".day")||0;a.set("tag_deliveries_today",c)}return b.metCriteria=e("expression").eval(b.criteria)},u={};a.set("tagsByName",u);var h=0,x=b.uniqueName=function(a){if(!a.named){for(var b=a.name,c=1;u[b];)c++,b=a.name+"_"+c;a.name=b;a.named=!0;u[b]=a}};b.deliver=function(b,c){c=c||
{};x(b);b.id=b.id||h++;b.time={mode:"async",start:a.ms()};b.method=b.method||(a.isFunction(b.content)?"apply":"document");"nativeIframe"===m&&b.target&&(b.method="nativeIframe");var d=function(c){b.error=c&&c.message&&c||{message:"unknown error"};a.fire("tag:fail",{id:b.id,alias:b.name,error:b.error.message})};a.fire("tag:started",{id:b.id,alias:b.name});try{return j[b.method](b,function(){b.time.end=a.ms();b.time.duration=b.time.end-b.time.start;if(b.freq_cap){var c="tag"+b.id+".day",d=+l.get(c)||
0;l.set(c,d+1,(g-new Date)/1E3)}a.fire("tag:done",{id:b.id,alias:b.name})},d,c)}catch(e){d(e)}};new (b.Timing=function(c){a.each(c,function(a){x(a)});var d,h=function(a){return a.time&&a.time.end||a.error||!1===a.metCriteria},e=function(){a.all(c,h)&&(e=a.doNothing,a.fireOnce("tag:all_done"))};a.on("tag:done",function(){e()});a.on("tag:fail",function(){e()});e();var f=function(h){d=a.filter(c,function(a){return a.timing===h});a.each(d,function(a){p(a)&&b.deliver(a)});e()},g=a.once(f,null,"onload"),
j=a.once(f,null,"onready");f("asap");i.ready(j);i.load(g);return{deliver:f,isDone:function(){return e!==a.doNothing}}})(a.get("tags"));e("test").module("tag-delivery",function(b){var c={};a.each(a.get("tags"),function(d){!a.happened("dom:beforeunload")&&!a.happened("dom:unload")&&b("tag_considered",null!=d.metCriteria,d.name);if(d.metCriteria){var h=d.time||{},e=h.start;b("tag_delivered",h.end,d.name);h=d.timing;b("tag_valid_timing_name",h,h);h=c[h]=c[h]||{lastStart:0};b("tag_order",e>=h.lastStart,
d.name);h.lastStart=e}})})});o("tag",function(b,e){e("util").extend(b,e("tag-delivery"))});o("test-visualtags",function(b,e){function c(a){return-1<(""+a).indexOf("px")?parseInt(a.replace("px",""),10)||0:0}function a(a,b){return Math.floor(100*(Math.abs(a-b)/b))}function i(a,b){return b["offset"+("width"===a?"Width":"Height")]||0}function k(a,b){g++;if(1E3<g)return 0;for(var c=0,d="offset"+("width"===a?"Width":"Height"),e=0;e<b.childNodes.length;e++)c=Math.max(c,b.childNodes[e][d]||0),b.childNodes[e].childNodes.length&&
(c=Math.max(c,k(a,b.childNodes[e])));return c}var l=e("util"),d=e("sizzle").find;b.init=function(){e("test").module("visualtags",function(b){for(var e=d(".kxtargeted"),g=0,q=e.length;g<q;g++){var j=e[g].getAttribute("data-id"),r=e[g].getAttribute("data-alias");a:{var o=l.get("tagsByName"),p=void 0;for(p in o)if(o[p].id===j){j=o[p].target||"";break a}j=""}j=d("#"+j);j=1===j.length?j[0]:e[g].parentNode;o=Math.max(i("width",e[g]),k("width",j));p=Math.max(i("height",e[g]),k("height",j));b("visualtag-not-blank",
o*p,"Tag area appears to be empty ("+r+")");j.style&&c(j.style.width)&&b("visualtag-expected-width",10>a(c(j.style.width),o),"Tag width ain't right ("+r+")");j.style&&c(j.style.height)&&b("visualtag-expected-height",10>a(c(j.style.height),p),"Tag height ain't right ("+r+")")}})};var g=0});o("test",function(b,e,c){var a=e("util"),i={},k="test";b.status="NOT_STARTED";var l=b.test=function(c,d,e){var g=d?"pass":"fail";b.results.push({module:k,code:c,data:e,assertion:d,time:new Date,status:g});a.fire("test:"+
g,{code:c,data:e});return d},d=function(b,c){return a.isArray(b)&&a.isArray(c)?b.length===c.length&&a.all(b,function(a,b){return d(a,c[b])}):b===c};l.eq=function(a,b,c){return l(a,d(b,c),{actual:b,expected:c})};b.module=function(a,c){"NOT_STARTED"!==b.status&&l("tests_not_started",!1,b.status);i[a]=c};var g=function(a,b){k=a;try{b(l)}catch(c){l("tests_module_threw",!1,"module_"+a+"_threw:"+c.message)}},m=b.run=function(){b.results=[];b.failureGroup=null;l("tests_to_run",!a.isEmpty(i));a.eachHash(i,
g);var d=b.report=a.groupBy(b.results,"status");d.total=b.results.length;d.toString=function(){try{var d=[],h=function(){d.push(Array.prototype.join.call(arguments,""))};h("Test Summary: "+b.status);h("Version: "+c.Krux.version+", "+c.Krux.commit);b.failureGroup&&h("Failure Group :"+b.failureGroup);h("Phase: "+b.phase);h("Status,Code,Data");a.each(b.results,function(a){h(a.status,",",a.code,",",a.data)});return d.join("\n")}catch(e){return"report.toString failed: "+e}};var e=b.status=d.status=d.fail?
"FAIL":"PASS";if("PASS"!==e){var m=-1,j,k=1E3,o=[],p={tests_to_run:k--,tests_module_threw:k--,pixel:k--,tag_delivered:k--};a.each(d.fail,function(a){var b=p[a.code]||0;o.push(a.code+": "+a.data);b>m&&(m=b,j=a)});b.failureGroup=j.code+(j.data?":"+j.data:"");b.phase=a.happened("dom:load")?"after_load":a.happened("dom:ready")?"after_ready_before_load":"before_ready"}a.fire("test:all_done",{status:e})};b.init=function(){var b=a.once(m);a.on("pixel",b);a.on("dom:beforeunload",b);a.on("dom:unload",b)}});
o("underscore",function(b,e,c){var a=b,i={},k=Array.prototype,l=Object.prototype,d=k.slice,g=l.toString,m=l.hasOwnProperty,f=k.map,n=k.reduce,q=k.filter,j=k.every,o=k.some,t=k.indexOf,k=Array.isArray,p=a.each=a.forEach=function(a,b,c){if(null!=a)if(a.length===+a.length)for(var d=0,e=a.length;d<e&&!(d in a&&b.call(c,a[d],d,a)===i);d++);else for(d in a)if(m.call(a,d)&&b.call(c,d,a[d],a)===i)break};a.map=function(a,b,c){var d=[];if(null==a)return d;if(f&&a.map===f)return a.map(b,c);p(a,function(a,h,
e){d[d.length]=b.call(c,a,h,e)});return d};a.find=a.detect=function(a,b,c){var d;u(a,function(a,h,e){if(b.call(c,a,h,e))return d=a,!0});return d};a.every=a.all=function(a,b,c){var d=!0;if(null==a)return d;if(j&&a.every===j)return a.every(b,c);p(a,function(a,h,e){if(!(d=d&&b.call(c,a,h,e)))return i});return d};var u=a.some=a.any=function(b,c,d){var c=c||a.identity,e=!1;if(null==b)return e;if(o&&b.some===o)return b.some(c,d);p(b,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return i});return!!e};a.include=
a.contains=function(a,b){var c=!1;return null==a?c:t&&a.indexOf===t?-1!=a.indexOf(b):c=u(a,function(a){return a===b})};a.filter=a.select=function(a,b,c){var d=[];if(null==a)return d;if(q&&a.filter===q)return a.filter(b,c);p(a,function(a,e,h){b.call(c,a,e,h)&&(d[d.length]=a)});return d};a.reduce=a.foldl=a.inject=function(b,c,d,e){var g=2<arguments.length;null==b&&(b=[]);if(n&&b.reduce===n)return e&&(c=a.bind(c,e)),g?b.reduce(c,d):b.reduce(c);p(b,function(a,b,h){g?d=c.call(e,d,a,b,h):(d=a,g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");
return d};a.indexOf=function(b,c,d){if(null==b)return-1;var e;if(d)return d=a.sortedIndex(b,c),b[d]===c?d:-1;if(t&&b.indexOf===t)return b.indexOf(c);d=0;for(e=b.length;d<e;d++)if(d in b&&b[d]===c)return d;return-1};a.uniq=a.unique=function(b,c,d){var d=d?a.map(b,d):b,e=[];3>b.length&&(c=!0);a.reduce(d,function(d,g,f){if(c?a.last(d)!==g||!d.length:!a.include(d,g))d.push(g),e.push(b[f]);return d},[]);return e};a.difference=function(b){var c=a.flatten(d.call(arguments,1),!0);return a.filter(b,function(b){return!a.include(c,
b)})};a.flatten=function(b,c){return a.reduce(b,function(b,d){if(a.isArray(d))return b.concat(c?d:a.flatten(d));b[b.length]=d;return b},[])};a.intersection=a.intersect=function(b){var c=d.call(arguments,1);return a.filter(a.uniq(b),function(b){return a.every(c,function(c){return 0<=a.indexOf(c,b)})})};a.groupBy=function(b,c){var d={},e=a.isFunction(c)?c:function(a){return a[c]};p(b,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)});return d};a.compact=function(b){return a.filter(b,function(a){return!!a})};
a.invoke=function(b,c){var e=d.call(arguments,2);return a.map(b,function(b){return(a.isFunction(c)?c||b:b[c]).apply(b,e)})};a.pluck=function(b,c){return a.map(b,function(a){return a[c]})};a.identity=function(a){return a};a.values=function(b){return a.map(b,a.identity)};a.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)};a.clone=function(b){return!a.isObject(b)?b:a.isArray(b)?b.slice():a.extend({},b)};a.extend=function(a){p(d.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])});
return a};a.defaults=function(a){p(d.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])});return a};a.first=a.head=function(a,b,c){return null!=b&&!c?d.call(a,0,b):a[0]};a.initial=function(a,b,c){return d.call(a,0,a.length-(null==b||c?1:b))};a.last=function(a,b,c){return null!=b&&!c?d.call(a,Math.max(a.length-b,0)):a[a.length-1]};a.rest=a.tail=function(a,b,c){return d.call(a,null==b||c?1:b)};a.toArray=function(b){return!b?[]:b.toArray?b.toArray():a.isArray(b)||a.isArguments(b)?d.call(b):
a.values(b)};a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};a.template=function(b,c){var d=a.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,
"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return c?e(c,a):function(b){return e.call(this,b,a)}};a.isEmpty=function(b){if(a.isArray(b)||a.isString(b))return 0===b.length;for(var c in b)if(m.call(b,c))return!1;return!0};a.isElement=function(a){return!!(a&&1==a.nodeType)};a.isArray=k||function(a){return"[object Array]"==
g.call(a)};a.isObject=function(a){return a===Object(a)};a.isArguments="[object Arguments]"==g.call(arguments)?function(a){return"[object Arguments]"==g.call(a)}:function(a){return!(!a||!m.call(a,"callee"))};a.isFunction=function(a){return"[object Function]"==g.call(a)};a.isString=function(a){return"[object String]"==g.call(a)};a.isNumber=function(a){return"[object Number]"==g.call(a)};a.isNaN=function(a){return a!==a};a.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==g.call(a)};a.isDate=
function(a){return"[object Date]"==g.call(a)};a.isRegExp=function(a){return"[object RegExp]"==g.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.now=Date.now||function(){return(new Date).getTime()};a.throttle=function(b,c,d){var e,g,f,j=null,i=0;d||(d={});var m=function(){i=!1===d.leading?0:a.now();j=null;f=b.apply(e,g);e=g=null};return function(){var k=a.now();!i&&!1===d.leading&&(i=k);var l=c-(k-i);e=this;g=arguments;0>=l?(clearTimeout(j),j=null,i=k,
f=b.apply(e,g),e=g=null):!j&&!1!==d.trailing&&(j=setTimeout(m,l));return f}}});o("util",function(b,e,c){var a=e("underscore"),i=/\S/;a.extend(b,a);a=b;a.globalEval=function(a,b){b=b||c;a&&i.test(a)&&b.eval.call(b,a)};a.parseParams=a.parseKeyValues=function(b,c,e,f){var c=c||"&",e=e||"=",f=f||decodeURIComponent,i={};if("string"!==typeof b)return i;b.replace(RegExp(c+"*([^"+e+c+"]+)"+e+"([^"+c+"]+)"+c+"*","g"),function(b,c,d){d=f(d);i[c]=!i[c]?d:a.isArray(i[c])?i[c].concat([d]):[i[c],d]});return i};
a.urlParams=function(b){b=(b||c.location.href).match(/[^\#?]+(?:\?([^#]*))?(?:#(.*))?/);return a.parseParams(a.compact(b.slice(1)).join("&"))};a.paramString=function(b,c,e,f){var c=c||"&",e=e||"=",f=f||encodeURIComponent,i=[];a.eachHash(b,function(b,c){c=a.isArray(c)?c:[c];a.each(c,function(a){null!=a&&""!==a&&i.push(f(b)+e+f(a))})});return i.join(c)};a.without=a.remove=function(b,c){return a.filter(b,function(a){return a!==c})};var k=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)",
"g");a.escapeRegexp=function(a){return(""+a).replace(k,"\\$1")};a.doNothing=new Function;a.defer=function(b){var e=a.rest(arguments);c.setTimeout(function(){b.apply(null,e)},0)};var l=[];l.toString=function(){return e("json").JSON.stringify(l)};a.log=function(b){if(a.isString(b))c.console&&console.log(b);else if(b)b.time=new Date,l.push(b);else return l};a.consoleLog=function(){c.console&&c.console.log&&c.console.log.apply(console,arguments)};a.Set=function(a){for(var b=0;b<a.length;b++)this[a[b]]=
!0};a.negate=function(a){return function(){return!a.apply(this,arguments)}};a.G=c;a.bind=function(b,c){if(b.isBound&&3>arguments.length)return b;var e=a.rest(arguments,2),f=function(){return b.apply(c,e.concat(a.toArray(arguments)))};f.actual=b;f.isBound=!0;return f};a.bindMethod=function(b,c){a.each(b.split(" "),function(b){c[b]=a.bind(c[b],c)})};a.interpolate=function(a,b){return b.replace(/\$\{([^{}]*)\}/g,function(b,c){var e=a[c];return"string"===typeof e||"number"===typeof e?e:b})};a.rewriter=
function(a){return function(b){return a[b]||b}};a.extend(a,{max:Math.max,min:Math.min});a.once=function(b){if(b.isOnce&&3>arguments.length)return b;var c=!1,b=a.bind.apply(null,arguments),e=function(){return!c&&(c=!0)&&b.apply(null,arguments)};e.isOnce=!0;e.actual=b;return e};a.isHash=function(a){return a.contructor===Object};a.ms=function(){return new Date-a.get("started")};a.param=function(a){var b;return(b=c.location.href.match("\\bkx"+a+"(?:=|\\b)([^&#]*)"))&&(b[1]||!0)};a.eachHash=a.each;a.mapHash=
function(b,c,e){var f={};a.eachHash(b,function(a,i){var j=c.call(e,a,i,b);f[j[0]]=j[1]});return f};a.anyHash=a.any;a.findHash=a.find;a.sniff=function(b,c){function e(b){return!b?a.doNothing:a.isRegExp(b)?function(c){return a.isString(c)&&c.match(b)}:b}var f=e(c.test),i=e(c.filter),k=c.depth||1,j=[],l=[],o=function(b){a.each(b,function(a,b){j.push("["+b+"]");u(a);j.pop()})},p=function(a){f(a)&&l.push(j.join(".")+":"+a)},u=function(b){var c=k;k--;try{if(c&&b)if(a.isArray(b))o(b);else if(a.isArguments(b))o(b);
else if(a.isString(b))p(b);else if(a.isNumber(b))p(b);else if(!a.isRegExp(b)&&!a.isFunction(b))for(var d in b)i(d)&&(j.push(d),f(d)&&l.push(j.join(".")),u(b[d]),j.pop())}catch(e){}k++};u(b);return l};a.keys=function(b){return a.map(b,function(a){return a})};a.values=function(b){return a.map(b,function(a,b){return b})};a.say=function(){};a.property=function(a){var b=function(a){return arguments.length?b.set(a):b.get()};b.get=a.get;b.set=a.set;a.value&&b.set(a.value);return b};a.attributes=function(b){var c=
function(b,d){var e=arguments.length;return 0===e?c.all():!a.isString(b)?c.set(b):1===e?c.get(b):c.set(b,d)};c.get=b.get;c.all=b.all;c.set=function(c,e){return 1===arguments.length?a.each(c,b.set):b.set(c,e)};b.values&&c.set(b.values);return c}});o("version",function(b){b.version="5.24.21";b.commit="882373c63900289f262f4d44812ea4d826b1c7c5"});y("index")})();
